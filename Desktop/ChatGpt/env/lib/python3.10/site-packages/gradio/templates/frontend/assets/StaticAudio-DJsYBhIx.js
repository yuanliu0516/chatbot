import"./IconButtonWrapper.svelte_svelte_type_style_lang-BiUMvbOz.js";import{f as Ue,u as qt}from"./utils-BsGrhMNe.js";import"./MarkdownCode.svelte_svelte_type_style_lang-CNW7HO6-.js";import{B as It}from"./BlockLabel-CCoHIDM7.js";import{I as Ut}from"./IconButton-B3BI2i6T.js";import{E as Vt}from"./Empty-B_fwEKaS.js";import{S as Ft}from"./ShareButton-HkxSYutN.js";import{D as Xt}from"./Download-DVtk-Jv3.js";import{M as ot}from"./Music-CDm0RGMk.js";import{I as xt}from"./IconButtonWrapper-BMUxHqmv.js";import{P as Gt,T as Zt}from"./Trim-JQYgj7Jd.js";import{P as Yt}from"./Play-B0Q0U1Qz.js";import{U as Kt}from"./Undo-DCjBnnSO.js";import{r as pt}from"./file-url-DgijyRSD.js";/* empty css                                                   */import{H as we}from"./hls-CnVhpNcu.js";import{D as Jt}from"./DownloadLink-IzUam-rM.js";const{SvelteComponent:Qt,append:ei,attr:G,detach:ti,init:ii,insert:ni,noop:xe,safe_not_equal:si,svg_element:gt}=window.__gradio__svelte__internal;function ri(r){let e,t;return{c(){e=gt("svg"),t=gt("path"),G(t,"stroke","currentColor"),G(t,"stroke-width","1.5"),G(t,"stroke-linecap","round"),G(t,"stroke-linejoin","round"),G(t,"d","M21.044 5.704a.6.6 0 0 1 .956.483v11.626a.6.6 0 0 1-.956.483l-7.889-5.813a.6.6 0 0 1 0-.966l7.89-5.813ZM10.044 5.704a.6.6 0 0 1 .956.483v11.626a.6.6 0 0 1-.956.483l-7.888-5.813a.6.6 0 0 1 0-.966l7.888-5.813Z"),G(e,"xmlns","http://www.w3.org/2000/svg"),G(e,"width","24px"),G(e,"height","24px"),G(e,"fill","currentColor"),G(e,"stroke-width","1.5"),G(e,"viewBox","0 0 24 24"),G(e,"color","currentColor")},m(i,n){ni(i,e,n),ei(e,t)},p:xe,i:xe,o:xe,d(i){i&&ti(e)}}}class oi extends Qt{constructor(e){super(),ii(this,e,null,ri,si,{})}}const{SvelteComponent:li,append:ai,attr:Z,detach:ui,init:di,insert:ci,noop:Ge,safe_not_equal:hi,svg_element:vt}=window.__gradio__svelte__internal;function fi(r){let e,t;return{c(){e=vt("svg"),t=vt("path"),Z(t,"stroke","currentColor"),Z(t,"stroke-width","1.5"),Z(t,"stroke-linecap","round"),Z(t,"stroke-linejoin","round"),Z(t,"d","M2.956 5.704A.6.6 0 0 0 2 6.187v11.626a.6.6 0 0 0 .956.483l7.889-5.813a.6.6 0 0 0 0-.966l-7.89-5.813ZM13.956 5.704a.6.6 0 0 0-.956.483v11.626a.6.6 0 0 0 .956.483l7.889-5.813a.6.6 0 0 0 0-.966l-7.89-5.813Z"),Z(e,"xmlns","http://www.w3.org/2000/svg"),Z(e,"width","24px"),Z(e,"height","24px"),Z(e,"fill","currentColor"),Z(e,"stroke-width","1.5"),Z(e,"viewBox","0 0 24 24"),Z(e,"color","currentColor")},m(i,n){ci(i,e,n),ai(e,t)},p:Ge,i:Ge,o:Ge,d(i){i&&ui(e)}}}class mi extends li{constructor(e){super(),di(this,e,null,fi,hi,{})}}const{SvelteComponent:_i,append:Be,attr:I,detach:pi,init:gi,insert:vi,noop:Ze,safe_not_equal:bi,svg_element:qe,text:wi}=window.__gradio__svelte__internal;function yi(r){let e,t,i,n,s;return{c(){e=qe("svg"),t=qe("title"),i=wi("Low volume"),n=qe("path"),s=qe("path"),I(n,"d","M19.5 7.5C19.5 7.5 21 9 21 11.5C21 14 19.5 15.5 19.5 15.5"),I(n,"stroke-width","1.5"),I(n,"stroke-linecap","round"),I(n,"stroke-linejoin","round"),I(s,"d","M2 13.8571V10.1429C2 9.03829 2.89543 8.14286 4 8.14286H6.9C7.09569 8.14286 7.28708 8.08544 7.45046 7.97772L13.4495 4.02228C14.1144 3.5839 15 4.06075 15 4.85714V19.1429C15 19.9392 14.1144 20.4161 13.4495 19.9777L7.45046 16.0223C7.28708 15.9146 7.09569 15.8571 6.9 15.8571H4C2.89543 15.8571 2 14.9617 2 13.8571Z"),I(s,"stroke-width","1.5"),I(e,"width","100%"),I(e,"height","100%"),I(e,"viewBox","0 0 24 24"),I(e,"stroke-width","1.5"),I(e,"fill","none"),I(e,"xmlns","http://www.w3.org/2000/svg"),I(e,"stroke","currentColor"),I(e,"color","currentColor")},m(o,a){vi(o,e,a),Be(e,t),Be(t,i),Be(e,n),Be(e,s)},p:Ze,i:Ze,o:Ze,d(o){o&&pi(e)}}}class ki extends _i{constructor(e){super(),gi(this,e,null,yi,bi,{})}}const{SvelteComponent:Ci,append:Le,attr:z,detach:Ei,init:Si,insert:Li,noop:Ye,safe_not_equal:Ri,svg_element:Re,text:Mi}=window.__gradio__svelte__internal;function $i(r){let e,t,i,n,s,o;return{c(){e=Re("svg"),t=Re("title"),i=Mi("High volume"),n=Re("path"),s=Re("path"),o=Re("path"),z(n,"d","M1 13.8571V10.1429C1 9.03829 1.89543 8.14286 3 8.14286H5.9C6.09569 8.14286 6.28708 8.08544 6.45046 7.97772L12.4495 4.02228C13.1144 3.5839 14 4.06075 14 4.85714V19.1429C14 19.9392 13.1144 20.4161 12.4495 19.9777L6.45046 16.0223C6.28708 15.9146 6.09569 15.8571 5.9 15.8571H3C1.89543 15.8571 1 14.9617 1 13.8571Z"),z(n,"stroke-width","1.5"),z(s,"d","M17.5 7.5C17.5 7.5 19 9 19 11.5C19 14 17.5 15.5 17.5 15.5"),z(s,"stroke-width","1.5"),z(s,"stroke-linecap","round"),z(s,"stroke-linejoin","round"),z(o,"d","M20.5 4.5C20.5 4.5 23 7 23 11.5C23 16 20.5 18.5 20.5 18.5"),z(o,"stroke-width","1.5"),z(o,"stroke-linecap","round"),z(o,"stroke-linejoin","round"),z(e,"width","100%"),z(e,"height","100%"),z(e,"viewBox","0 0 24 24"),z(e,"stroke-width","1.5"),z(e,"fill","none"),z(e,"stroke","currentColor"),z(e,"xmlns","http://www.w3.org/2000/svg"),z(e,"color","currentColor")},m(a,u){Li(a,e,u),Le(e,t),Le(t,i),Le(e,n),Le(e,s),Le(e,o)},p:Ye,i:Ye,o:Ye,d(a){a&&Ei(e)}}}class Di extends Ci{constructor(e){super(),Si(this,e,null,$i,Ri,{})}}const{SvelteComponent:Pi,append:ne,attr:W,detach:Ti,init:Ai,insert:Wi,noop:Ke,safe_not_equal:Oi,svg_element:se,text:zi}=window.__gradio__svelte__internal;function Hi(r){let e,t,i,n,s,o,a,u,c;return{c(){e=se("svg"),t=se("title"),i=zi("Muted volume"),n=se("g"),s=se("path"),o=se("path"),a=se("defs"),u=se("clipPath"),c=se("rect"),W(s,"d","M18 14L20.0005 12M22 10L20.0005 12M20.0005 12L18 10M20.0005 12L22 14"),W(s,"stroke-width","1.5"),W(s,"stroke-linecap","round"),W(s,"stroke-linejoin","round"),W(o,"d","M2 13.8571V10.1429C2 9.03829 2.89543 8.14286 4 8.14286H6.9C7.09569 8.14286 7.28708 8.08544 7.45046 7.97772L13.4495 4.02228C14.1144 3.5839 15 4.06075 15 4.85714V19.1429C15 19.9392 14.1144 20.4161 13.4495 19.9777L7.45046 16.0223C7.28708 15.9146 7.09569 15.8571 6.9 15.8571H4C2.89543 15.8571 2 14.9617 2 13.8571Z"),W(o,"stroke-width","1.5"),W(n,"clip-path","url(#clip0_3173_16686)"),W(c,"width","24"),W(c,"height","24"),W(c,"fill","white"),W(u,"id","clip0_3173_16686"),W(e,"width","100%"),W(e,"height","100%"),W(e,"viewBox","0 0 24 24"),W(e,"stroke-width","1.5"),W(e,"fill","none"),W(e,"xmlns","http://www.w3.org/2000/svg"),W(e,"stroke","currentColor"),W(e,"color","currentColor")},m(l,d){Wi(l,e,d),ne(e,t),ne(t,i),ne(e,n),ne(n,s),ne(n,o),ne(e,a),ne(a,u),ne(u,c)},p:Ke,i:Ke,o:Ke,d(l){l&&Ti(e)}}}class Vi extends Pi{constructor(e){super(),Ai(this,e,null,Hi,Oi,{})}}var Ni=function(r,e,t,i){function n(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(l){try{c(i.next(l))}catch(d){o(d)}}function u(l){try{c(i.throw(l))}catch(d){o(d)}}function c(l){l.done?s(l.value):n(l.value).then(a,u)}c((i=i.apply(r,e||[])).next())})};function ji(r,e){return Ni(this,void 0,void 0,function*(){const t=new AudioContext({sampleRate:e});return t.decodeAudioData(r).finally(()=>t.close())})}function Bi(r){const e=r[0];if(e.some(t=>t>1||t<-1)){const t=e.length;let i=0;for(let n=0;n<t;n++){const s=Math.abs(e[n]);s>i&&(i=s)}for(const n of r)for(let s=0;s<t;s++)n[s]/=i}return r}function qi(r,e){return typeof r[0]=="number"&&(r=[r]),Bi(r),{duration:e,length:r[0].length,sampleRate:r[0].length/e,numberOfChannels:r.length,getChannelData:t=>r?.[t],copyFromChannel:AudioBuffer.prototype.copyFromChannel,copyToChannel:AudioBuffer.prototype.copyToChannel}}const Je={decode:ji,createBuffer:qi};var bt=function(r,e,t,i){function n(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(l){try{c(i.next(l))}catch(d){o(d)}}function u(l){try{c(i.throw(l))}catch(d){o(d)}}function c(l){l.done?s(l.value):n(l.value).then(a,u)}c((i=i.apply(r,e||[])).next())})};function Ii(r,e,t){var i,n;return bt(this,void 0,void 0,function*(){const s=yield fetch(r,t);{const o=(i=s.clone().body)===null||i===void 0?void 0:i.getReader(),a=Number((n=s.headers)===null||n===void 0?void 0:n.get("Content-Length"));let u=0;const c=(l,d)=>bt(this,void 0,void 0,function*(){if(l)return;u+=d?.length||0;const p=Math.round(u/a*100);return e(p),o?.read().then(({done:h,value:f})=>c(h,f))});o?.read().then(({done:l,value:d})=>c(l,d))}return s.blob()})}const Ui={fetchBlob:Ii};class Fe{constructor(){this.listeners={},this.on=this.addEventListener,this.un=this.removeEventListener}addEventListener(e,t,i){if(this.listeners[e]||(this.listeners[e]=new Set),this.listeners[e].add(t),i?.once){const n=()=>{this.removeEventListener(e,n),this.removeEventListener(e,t)};return this.addEventListener(e,n),n}return()=>this.removeEventListener(e,t)}removeEventListener(e,t){var i;(i=this.listeners[e])===null||i===void 0||i.delete(t)}once(e,t){return this.on(e,t,{once:!0})}unAll(){this.listeners={}}emit(e,...t){this.listeners[e]&&this.listeners[e].forEach(i=>i(...t))}}class Fi extends Fe{constructor(e){super(),this.isExternalMedia=!1,e.media?(this.media=e.media,this.isExternalMedia=!0):this.media=document.createElement("audio"),e.mediaControls&&(this.media.controls=!0),e.autoplay&&(this.media.autoplay=!0),e.playbackRate!=null&&this.onceMediaEvent("canplay",()=>{e.playbackRate!=null&&(this.media.playbackRate=e.playbackRate)})}onMediaEvent(e,t,i){return this.media.addEventListener(e,t,i),()=>this.media.removeEventListener(e,t)}onceMediaEvent(e,t){return this.onMediaEvent(e,t,{once:!0})}getSrc(){return this.media.currentSrc||this.media.src||""}revokeSrc(){const e=this.getSrc();e.startsWith("blob:")&&URL.revokeObjectURL(e)}setSrc(e,t){if(this.getSrc()===e)return;this.revokeSrc();const n=t instanceof Blob?URL.createObjectURL(t):e;this.media.src=n,this.media.load()}destroy(){this.media.pause(),!this.isExternalMedia&&(this.media.remove(),this.revokeSrc(),this.media.src="",this.media.load())}setMediaElement(e){this.media=e}play(){return this.media.play()}pause(){this.media.pause()}isPlaying(){return!this.media.paused&&!this.media.ended}setTime(e){this.media.currentTime=e}getDuration(){return this.media.duration}getCurrentTime(){return this.media.currentTime}getVolume(){return this.media.volume}setVolume(e){this.media.volume=e}getMuted(){return this.media.muted}setMuted(e){this.media.muted=e}getPlaybackRate(){return this.media.playbackRate}setPlaybackRate(e,t){t!=null&&(this.media.preservesPitch=t),this.media.playbackRate=e}getMediaElement(){return this.media}setSinkId(e){return this.media.setSinkId(e)}}function Xi(r,e,t,i,n=5){let s=()=>{};if(!r)return s;const o=a=>{if(a.button===2)return;a.preventDefault(),a.stopPropagation(),r.style.touchAction="none";let u=a.clientX,c=a.clientY,l=!1;const d=f=>{f.preventDefault(),f.stopPropagation();const k=f.clientX,S=f.clientY;if(l||Math.abs(k-u)>=n||Math.abs(S-c)>=n){const{left:b,top:w}=r.getBoundingClientRect();l||(l=!0,t?.(u-b,c-w)),e(k-u,S-c,k-b,S-w),u=k,c=S}},p=f=>{l&&(f.preventDefault(),f.stopPropagation())},h=()=>{r.style.touchAction="",l&&i?.(),s()};document.addEventListener("pointermove",d),document.addEventListener("pointerup",h),document.addEventListener("pointerleave",h),document.addEventListener("click",p,!0),s=()=>{document.removeEventListener("pointermove",d),document.removeEventListener("pointerup",h),document.removeEventListener("pointerleave",h),setTimeout(()=>{document.removeEventListener("click",p,!0)},10)}};return r.addEventListener("pointerdown",o),()=>{s(),r.removeEventListener("pointerdown",o)}}class Xe extends Fe{constructor(e,t){super(),this.timeouts=[],this.isScrolling=!1,this.audioData=null,this.resizeObserver=null,this.isDragging=!1,this.options=e;const i=this.parentFromOptionsContainer(e.container);this.parent=i;const[n,s]=this.initHtml();i.appendChild(n),this.container=n,this.scrollContainer=s.querySelector(".scroll"),this.wrapper=s.querySelector(".wrapper"),this.canvasWrapper=s.querySelector(".canvases"),this.progressWrapper=s.querySelector(".progress"),this.cursor=s.querySelector(".cursor"),t&&s.appendChild(t),this.initEvents()}parentFromOptionsContainer(e){let t;if(typeof e=="string"?t=document.querySelector(e):e instanceof HTMLElement&&(t=e),!t)throw new Error("Container not found");return t}initEvents(){const e=i=>{const n=this.wrapper.getBoundingClientRect(),s=i.clientX-n.left,o=i.clientX-n.left,a=s/n.width,u=o/n.height;return[a,u]};this.wrapper.addEventListener("click",i=>{const[n,s]=e(i);this.emit("click",n,s)}),this.wrapper.addEventListener("dblclick",i=>{const[n,s]=e(i);this.emit("dblclick",n,s)}),this.options.dragToSeek&&this.initDrag(),this.scrollContainer.addEventListener("scroll",()=>{const{scrollLeft:i,scrollWidth:n,clientWidth:s}=this.scrollContainer,o=i/n,a=(i+s)/n;this.emit("scroll",o,a)});const t=this.createDelay(100);this.resizeObserver=new ResizeObserver(()=>{t(()=>this.reRender())}),this.resizeObserver.observe(this.scrollContainer)}initDrag(){Xi(this.wrapper,(e,t,i)=>{this.emit("drag",Math.max(0,Math.min(1,i/this.wrapper.getBoundingClientRect().width)))},()=>this.isDragging=!0,()=>this.isDragging=!1)}getHeight(){return this.options.height==null?128:isNaN(Number(this.options.height))?this.options.height==="auto"&&this.parent.clientHeight||128:Number(this.options.height)}initHtml(){const e=document.createElement("div"),t=e.attachShadow({mode:"open"});return t.innerHTML=`
      <style>
        :host {
          user-select: none;
          min-width: 1px;
        }
        :host audio {
          display: block;
          width: 100%;
        }
        :host .scroll {
          overflow-x: auto;
          overflow-y: hidden;
          width: 100%;
          position: relative;
        }
        :host .noScrollbar {
          scrollbar-color: transparent;
          scrollbar-width: none;
        }
        :host .noScrollbar::-webkit-scrollbar {
          display: none;
          -webkit-appearance: none;
        }
        :host .wrapper {
          position: relative;
          overflow: visible;
          z-index: 2;
        }
        :host .canvases {
          min-height: ${this.getHeight()}px;
        }
        :host .canvases > div {
          position: relative;
        }
        :host canvas {
          display: block;
          position: absolute;
          top: 0;
          image-rendering: pixelated;
        }
        :host .progress {
          pointer-events: none;
          position: absolute;
          z-index: 2;
          top: 0;
          left: 0;
          width: 0;
          height: 100%;
          overflow: hidden;
        }
        :host .progress > div {
          position: relative;
        }
        :host .cursor {
          pointer-events: none;
          position: absolute;
          z-index: 5;
          top: 0;
          left: 0;
          height: 100%;
          border-radius: 2px;
        }
      </style>

      <div class="scroll" part="scroll">
        <div class="wrapper" part="wrapper">
          <div class="canvases"></div>
          <div class="progress" part="progress"></div>
          <div class="cursor" part="cursor"></div>
        </div>
      </div>
    `,[e,t]}setOptions(e){if(this.options.container!==e.container){const t=this.parentFromOptionsContainer(e.container);t.appendChild(this.container),this.parent=t}e.dragToSeek&&!this.options.dragToSeek&&this.initDrag(),this.options=e,this.reRender()}getWrapper(){return this.wrapper}getScroll(){return this.scrollContainer.scrollLeft}destroy(){var e;this.container.remove(),(e=this.resizeObserver)===null||e===void 0||e.disconnect()}createDelay(e=10){const t={};return this.timeouts.push(t),i=>{t.timeout&&clearTimeout(t.timeout),t.timeout=setTimeout(i,e)}}convertColorValues(e){if(!Array.isArray(e))return e||"";if(e.length<2)return e[0]||"";const t=document.createElement("canvas"),n=t.getContext("2d").createLinearGradient(0,0,0,t.height),s=1/(e.length-1);return e.forEach((o,a)=>{const u=a*s;n.addColorStop(u,o)}),n}renderBarWaveform(e,t,i,n){const s=e[0],o=e[1]||e[0],a=s.length,{width:u,height:c}=i.canvas,l=c/2,d=window.devicePixelRatio||1,p=t.barWidth?t.barWidth*d:1,h=t.barGap?t.barGap*d:t.barWidth?p/2:0,f=t.barRadius||0,k=u/(p+h)/a,S=f&&"roundRect"in i?"roundRect":"rect";i.beginPath();let b=0,w=0,R=0;for(let E=0;E<=a;E++){const y=Math.round(E*k);if(y>b){const C=Math.round(w*l*n),M=Math.round(R*l*n),N=C+M||1;let x=l-C;t.barAlign==="top"?x=0:t.barAlign==="bottom"&&(x=c-N),i[S](b*(p+h),x,p,N,f),b=y,w=0,R=0}const m=Math.abs(s[E]||0),g=Math.abs(o[E]||0);m>w&&(w=m),g>R&&(R=g)}i.fill(),i.closePath()}renderLineWaveform(e,t,i,n){const s=o=>{const a=e[o]||e[0],u=a.length,{height:c}=i.canvas,l=c/2,d=i.canvas.width/u;i.moveTo(0,l);let p=0,h=0;for(let f=0;f<=u;f++){const k=Math.round(f*d);if(k>p){const b=Math.round(h*l*n)||1,w=l+b*(o===0?-1:1);i.lineTo(p,w),p=k,h=0}const S=Math.abs(a[f]||0);S>h&&(h=S)}i.lineTo(p,l)};i.beginPath(),s(0),s(1),i.fill(),i.closePath()}renderWaveform(e,t,i){if(i.fillStyle=this.convertColorValues(t.waveColor),t.renderFunction){t.renderFunction(e,i);return}let n=t.barHeight||1;if(t.normalize){const s=Array.from(e[0]).reduce((o,a)=>Math.max(o,Math.abs(a)),0);n=s?1/s:1}if(t.barWidth||t.barGap||t.barAlign){this.renderBarWaveform(e,t,i,n);return}this.renderLineWaveform(e,t,i,n)}renderSingleCanvas(e,t,i,n,s,o,a,u){const c=window.devicePixelRatio||1,l=document.createElement("canvas"),d=e[0].length;l.width=Math.round(i*(o-s)/d),l.height=n*c,l.style.width=`${Math.floor(l.width/c)}px`,l.style.height=`${n}px`,l.style.left=`${Math.floor(s*i/c/d)}px`,a.appendChild(l);const p=l.getContext("2d");if(this.renderWaveform(e.map(h=>h.slice(s,o)),t,p),l.width>0&&l.height>0){const h=l.cloneNode(),f=h.getContext("2d");f.drawImage(l,0,0),f.globalCompositeOperation="source-in",f.fillStyle=this.convertColorValues(t.progressColor),f.fillRect(0,0,l.width,l.height),u.appendChild(h)}}renderChannel(e,t,i){const n=document.createElement("div"),s=this.getHeight();n.style.height=`${s}px`,this.canvasWrapper.style.minHeight=`${s}px`,this.canvasWrapper.appendChild(n);const o=n.cloneNode();this.progressWrapper.appendChild(o);const{scrollLeft:a,scrollWidth:u,clientWidth:c}=this.scrollContainer,l=e[0].length,d=l/u;let p=Math.min(Xe.MAX_CANVAS_WIDTH,c);if(t.barWidth||t.barGap){const y=t.barWidth||.5,m=t.barGap||y/2,g=y+m;p%g!==0&&(p=Math.floor(p/g)*g)}const h=Math.floor(Math.abs(a)*d),f=Math.floor(h+p*d),k=f-h,S=(y,m)=>{this.renderSingleCanvas(e,t,i,s,Math.max(0,y),Math.min(m,l),n,o)},b=this.createDelay(),w=this.createDelay(),R=(y,m)=>{S(y,m),y>0&&b(()=>{R(y-k,m-k)})},E=(y,m)=>{S(y,m),m<l&&w(()=>{E(y+k,m+k)})};R(h,f),f<l&&E(f,f+k)}render(e){this.timeouts.forEach(a=>a.timeout&&clearTimeout(a.timeout)),this.timeouts=[],this.canvasWrapper.innerHTML="",this.progressWrapper.innerHTML="",this.wrapper.style.width="",this.options.width!=null&&(this.scrollContainer.style.width=typeof this.options.width=="number"?`${this.options.width}px`:this.options.width);const t=window.devicePixelRatio||1,i=this.scrollContainer.clientWidth,n=Math.ceil(e.duration*(this.options.minPxPerSec||0));this.isScrolling=n>i;const s=this.options.fillParent&&!this.isScrolling,o=(s?i:n)*t;if(this.wrapper.style.width=s?"100%":`${n}px`,this.scrollContainer.style.overflowX=this.isScrolling?"auto":"hidden",this.scrollContainer.classList.toggle("noScrollbar",!!this.options.hideScrollbar),this.cursor.style.backgroundColor=`${this.options.cursorColor||this.options.progressColor}`,this.cursor.style.width=`${this.options.cursorWidth}px`,this.options.splitChannels)for(let a=0;a<e.numberOfChannels;a++){const u=Object.assign(Object.assign({},this.options),this.options.splitChannels[a]);this.renderChannel([e.getChannelData(a)],u,o)}else{const a=[e.getChannelData(0)];e.numberOfChannels>1&&a.push(e.getChannelData(1)),this.renderChannel(a,this.options,o)}this.audioData=e,this.emit("render")}reRender(){if(!this.audioData)return;const e=this.progressWrapper.clientWidth;this.render(this.audioData);const t=this.progressWrapper.clientWidth;this.scrollContainer.scrollLeft+=t-e}zoom(e){this.options.minPxPerSec=e,this.reRender()}scrollIntoView(e,t=!1){const{clientWidth:i,scrollLeft:n,scrollWidth:s}=this.scrollContainer,o=s*e,a=i/2,u=t&&this.options.autoCenter&&!this.isDragging?a:i;if(o>n+u||o<n)if(this.options.autoCenter&&!this.isDragging){const c=a/20;o-(n+a)>=c&&o<n+i?this.scrollContainer.scrollLeft+=c:this.scrollContainer.scrollLeft=o-a}else this.isDragging?this.scrollContainer.scrollLeft=o<n?o-10:o-i+10:this.scrollContainer.scrollLeft=o;{const{scrollLeft:c}=this.scrollContainer,l=c/s,d=(c+i)/s;this.emit("scroll",l,d)}}renderProgress(e,t){if(isNaN(e))return;const i=e*100;this.canvasWrapper.style.clipPath=`polygon(${i}% 0, 100% 0, 100% 100%, ${i}% 100%)`,this.progressWrapper.style.width=`${i}%`,this.cursor.style.left=`${i}%`,this.cursor.style.marginLeft=Math.round(i)===100?`-${this.options.cursorWidth}px`:"",this.isScrolling&&this.options.autoScroll&&this.scrollIntoView(e,t)}}Xe.MAX_CANVAS_WIDTH=4e3;class xi extends Fe{constructor(){super(...arguments),this.unsubscribe=()=>{}}start(){this.unsubscribe=this.on("tick",()=>{requestAnimationFrame(()=>{this.emit("tick")})}),this.emit("tick")}stop(){this.unsubscribe()}destroy(){this.unsubscribe()}}var Qe=function(r,e,t,i){function n(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(l){try{c(i.next(l))}catch(d){o(d)}}function u(l){try{c(i.throw(l))}catch(d){o(d)}}function c(l){l.done?s(l.value):n(l.value).then(a,u)}c((i=i.apply(r,e||[])).next())})};class Gi extends Fe{constructor(e=new AudioContext){super(),this.bufferNode=null,this.autoplay=!1,this.playStartTime=0,this.playedDuration=0,this._muted=!1,this.buffer=null,this.currentSrc="",this.paused=!0,this.crossOrigin=null,this.audioContext=e,this.gainNode=this.audioContext.createGain(),this.gainNode.connect(this.audioContext.destination)}load(){return Qe(this,void 0,void 0,function*(){})}get src(){return this.currentSrc}set src(e){this.currentSrc=e,fetch(e).then(t=>t.arrayBuffer()).then(t=>this.audioContext.decodeAudioData(t)).then(t=>{this.buffer=t,this.emit("loadedmetadata"),this.emit("canplay"),this.autoplay&&this.play()})}_play(){var e;this.paused&&(this.paused=!1,(e=this.bufferNode)===null||e===void 0||e.disconnect(),this.bufferNode=this.audioContext.createBufferSource(),this.bufferNode.buffer=this.buffer,this.bufferNode.connect(this.gainNode),this.playedDuration>=this.duration&&(this.playedDuration=0),this.bufferNode.start(this.audioContext.currentTime,this.playedDuration),this.playStartTime=this.audioContext.currentTime,this.bufferNode.onended=()=>{this.currentTime>=this.duration&&(this.pause(),this.emit("ended"))})}_pause(){var e;this.paused||(this.paused=!0,(e=this.bufferNode)===null||e===void 0||e.stop(),this.playedDuration+=this.audioContext.currentTime-this.playStartTime)}play(){return Qe(this,void 0,void 0,function*(){this._play(),this.emit("play")})}pause(){this._pause(),this.emit("pause")}setSinkId(e){return Qe(this,void 0,void 0,function*(){return this.audioContext.setSinkId(e)})}get playbackRate(){var e,t;return(t=(e=this.bufferNode)===null||e===void 0?void 0:e.playbackRate.value)!==null&&t!==void 0?t:1}set playbackRate(e){this.bufferNode&&(this.bufferNode.playbackRate.value=e)}get currentTime(){return this.paused?this.playedDuration:this.playedDuration+this.audioContext.currentTime-this.playStartTime}set currentTime(e){this.emit("seeking"),this.paused?this.playedDuration=e:(this._pause(),this.playedDuration=e,this._play()),this.emit("timeupdate")}get duration(){var e;return((e=this.buffer)===null||e===void 0?void 0:e.duration)||0}get volume(){return this.gainNode.gain.value}set volume(e){this.gainNode.gain.value=e,this.emit("volumechange")}get muted(){return this._muted}set muted(e){this._muted!==e&&(this._muted=e,this._muted?this.gainNode.disconnect():this.gainNode.connect(this.audioContext.destination))}getGainNode(){return this.gainNode}}var ye=function(r,e,t,i){function n(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(l){try{c(i.next(l))}catch(d){o(d)}}function u(l){try{c(i.throw(l))}catch(d){o(d)}}function c(l){l.done?s(l.value):n(l.value).then(a,u)}c((i=i.apply(r,e||[])).next())})};const Zi={waveColor:"#999",progressColor:"#555",cursorWidth:1,minPxPerSec:0,fillParent:!0,interact:!0,dragToSeek:!1,autoScroll:!0,autoCenter:!0,sampleRate:8e3};class lt extends Fi{static create(e){return new lt(e)}constructor(e){const t=e.media||(e.backend==="WebAudio"?new Gi:void 0);super({media:t,mediaControls:e.mediaControls,autoplay:e.autoplay,playbackRate:e.audioRate}),this.plugins=[],this.decodedData=null,this.subscriptions=[],this.mediaSubscriptions=[],this.options=Object.assign({},Zi,e),this.timer=new xi;const i=t?void 0:this.getMediaElement();this.renderer=new Xe(this.options,i),this.initPlayerEvents(),this.initRendererEvents(),this.initTimerEvents(),this.initPlugins();const n=this.options.url||this.getSrc();n?this.load(n,this.options.peaks,this.options.duration):this.options.peaks&&this.options.duration&&this.loadPredecoded()}initTimerEvents(){this.subscriptions.push(this.timer.on("tick",()=>{const e=this.getCurrentTime();this.renderer.renderProgress(e/this.getDuration(),!0),this.emit("timeupdate",e),this.emit("audioprocess",e)}))}initPlayerEvents(){this.mediaSubscriptions.push(this.onMediaEvent("timeupdate",()=>{const e=this.getCurrentTime();this.renderer.renderProgress(e/this.getDuration(),this.isPlaying()),this.emit("timeupdate",e)}),this.onMediaEvent("play",()=>{this.emit("play"),this.timer.start()}),this.onMediaEvent("pause",()=>{this.emit("pause"),this.timer.stop()}),this.onMediaEvent("emptied",()=>{this.timer.stop()}),this.onMediaEvent("ended",()=>{this.emit("finish")}),this.onMediaEvent("seeking",()=>{this.emit("seeking",this.getCurrentTime())}))}initRendererEvents(){this.subscriptions.push(this.renderer.on("click",(e,t)=>{this.options.interact&&(this.seekTo(e),this.emit("interaction",e*this.getDuration()),this.emit("click",e,t))}),this.renderer.on("dblclick",(e,t)=>{this.emit("dblclick",e,t)}),this.renderer.on("scroll",(e,t)=>{const i=this.getDuration();this.emit("scroll",e*i,t*i)}),this.renderer.on("render",()=>{this.emit("redraw")}));{let e;this.subscriptions.push(this.renderer.on("drag",t=>{this.options.interact&&(this.renderer.renderProgress(t),clearTimeout(e),e=setTimeout(()=>{this.seekTo(t)},this.isPlaying()?0:200),this.emit("interaction",t*this.getDuration()),this.emit("drag",t))}))}}initPlugins(){var e;!((e=this.options.plugins)===null||e===void 0)&&e.length&&this.options.plugins.forEach(t=>{this.registerPlugin(t)})}unsubscribePlayerEvents(){this.mediaSubscriptions.forEach(e=>e()),this.mediaSubscriptions=[]}setOptions(e){this.options=Object.assign({},this.options,e),this.renderer.setOptions(this.options),e.audioRate&&this.setPlaybackRate(e.audioRate),e.mediaControls!=null&&(this.getMediaElement().controls=e.mediaControls)}registerPlugin(e){return e.init(this),this.plugins.push(e),this.subscriptions.push(e.once("destroy",()=>{this.plugins=this.plugins.filter(t=>t!==e)})),e}getWrapper(){return this.renderer.getWrapper()}getScroll(){return this.renderer.getScroll()}getActivePlugins(){return this.plugins}loadPredecoded(){return ye(this,void 0,void 0,function*(){this.options.peaks&&this.options.duration&&(this.decodedData=Je.createBuffer(this.options.peaks,this.options.duration),yield Promise.resolve(),this.renderDecoded())})}renderDecoded(){return ye(this,void 0,void 0,function*(){this.decodedData&&(this.emit("decode",this.getDuration()),this.renderer.render(this.decodedData))})}loadAudio(e,t,i,n){return ye(this,void 0,void 0,function*(){if(this.emit("load",e),!this.options.media&&this.isPlaying()&&this.pause(),this.decodedData=null,!t&&!i){const s=o=>this.emit("loading",o);t=yield Ui.fetchBlob(e,s,this.options.fetchParams)}if(this.setSrc(e,t),n=(yield Promise.resolve(n||this.getDuration()))||(yield new Promise(s=>{this.onceMediaEvent("loadedmetadata",()=>s(this.getDuration()))}))||(yield Promise.resolve(0)),i)this.decodedData=Je.createBuffer(i,n);else if(t){const s=yield t.arrayBuffer();this.decodedData=yield Je.decode(s,this.options.sampleRate)}this.renderDecoded(),this.emit("ready",this.getDuration())})}load(e,t,i){return ye(this,void 0,void 0,function*(){yield this.loadAudio(e,void 0,t,i)})}loadBlob(e,t,i){return ye(this,void 0,void 0,function*(){yield this.loadAudio("blob",e,t,i)})}zoom(e){if(!this.decodedData)throw new Error("No audio loaded");this.renderer.zoom(e),this.emit("zoom",e)}getDecodedData(){return this.decodedData}exportPeaks({channels:e=2,maxLength:t=8e3,precision:i=1e4}={}){if(!this.decodedData)throw new Error("The audio has not been decoded yet");const n=Math.min(e,this.decodedData.numberOfChannels),s=[];for(let o=0;o<n;o++){const a=this.decodedData.getChannelData(o),u=[],c=Math.round(a.length/t);for(let l=0;l<t;l++){const d=a.slice(l*c,(l+1)*c),p=Math.max(...d);u.push(Math.round(p*i)/i)}s.push(u)}return s}getDuration(){let e=super.getDuration()||0;return(e===0||e===1/0)&&this.decodedData&&(e=this.decodedData.duration),e}toggleInteraction(e){this.options.interact=e}seekTo(e){const t=this.getDuration()*e;this.setTime(t)}playPause(){return ye(this,void 0,void 0,function*(){return this.isPlaying()?this.pause():this.play()})}stop(){this.pause(),this.setTime(0)}skip(e){this.setTime(this.getCurrentTime()+e)}empty(){this.load("",[[0]],.001)}setMediaElement(e){this.unsubscribePlayerEvents(),super.setMediaElement(e),this.initPlayerEvents()}destroy(){this.emit("destroy"),this.plugins.forEach(e=>e.destroy()),this.subscriptions.forEach(e=>e()),this.unsubscribePlayerEvents(),this.timer.destroy(),this.renderer.destroy(),super.destroy()}}function Yi(r){const e=r.numberOfChannels,t=r.length*e*2+44,i=new ArrayBuffer(t),n=new DataView(i);let s=0;const o=function(a,u,c){for(let l=0;l<c.length;l++)a.setUint8(u+l,c.charCodeAt(l))};o(n,s,"RIFF"),s+=4,n.setUint32(s,t-8,!0),s+=4,o(n,s,"WAVE"),s+=4,o(n,s,"fmt "),s+=4,n.setUint32(s,16,!0),s+=4,n.setUint16(s,1,!0),s+=2,n.setUint16(s,e,!0),s+=2,n.setUint32(s,r.sampleRate,!0),s+=4,n.setUint32(s,r.sampleRate*2*e,!0),s+=4,n.setUint16(s,e*2,!0),s+=2,n.setUint16(s,16,!0),s+=2,o(n,s,"data"),s+=4,n.setUint32(s,r.length*e*2,!0),s+=4;for(let a=0;a<r.length;a++)for(let u=0;u<e;u++){const c=Math.max(-1,Math.min(1,r.getChannelData(u)[a]));n.setInt16(s,c*32767,!0),s+=2}return new Uint8Array(i)}const Ki=async(r,e,t,i)=>{const n=new AudioContext({sampleRate:i||r.sampleRate}),s=r.numberOfChannels,o=i||r.sampleRate;let a=r.length,u=0;e&&t&&(u=Math.round(e*o),a=Math.round(t*o)-u);const c=n.createBuffer(s,a,o);for(let l=0;l<s;l++){const d=r.getChannelData(l),p=c.getChannelData(l);for(let h=0;h<a;h++)p[h]=d[u+h]}return Yi(c)},wt=(r,e)=>{r&&r.skip(e)},Ee=(r,e)=>(e||(e=5),r/100*e||5);class Nt{constructor(){this.listeners={},this.on=this.addEventListener,this.un=this.removeEventListener}addEventListener(e,t,i){if(this.listeners[e]||(this.listeners[e]=new Set),this.listeners[e].add(t),i?.once){const n=()=>{this.removeEventListener(e,n),this.removeEventListener(e,t)};return this.addEventListener(e,n),n}return()=>this.removeEventListener(e,t)}removeEventListener(e,t){var i;(i=this.listeners[e])===null||i===void 0||i.delete(t)}once(e,t){return this.on(e,t,{once:!0})}unAll(){this.listeners={}}emit(e,...t){this.listeners[e]&&this.listeners[e].forEach(i=>i(...t))}}class Ji extends Nt{constructor(e){super(),this.subscriptions=[],this.options=e}onInit(){}init(e){this.wavesurfer=e,this.onInit()}destroy(){this.emit("destroy"),this.subscriptions.forEach(e=>e())}}function Ie(r,e,t,i,n=5){let s=()=>{};if(!r)return s;const o=a=>{if(a.button===2)return;a.preventDefault(),a.stopPropagation(),r.style.touchAction="none";let u=a.clientX,c=a.clientY,l=!1;const d=f=>{f.preventDefault(),f.stopPropagation();const k=f.clientX,S=f.clientY;if(l||Math.abs(k-u)>=n||Math.abs(S-c)>=n){const{left:b,top:w}=r.getBoundingClientRect();l||(l=!0,t?.(u-b,c-w)),e(k-u,S-c,k-b,S-w),u=k,c=S}},p=f=>{l&&(f.preventDefault(),f.stopPropagation())},h=()=>{r.style.touchAction="",l&&i?.(),s()};document.addEventListener("pointermove",d),document.addEventListener("pointerup",h),document.addEventListener("pointerleave",h),document.addEventListener("click",p,!0),s=()=>{document.removeEventListener("pointermove",d),document.removeEventListener("pointerup",h),document.removeEventListener("pointerleave",h),setTimeout(()=>{document.removeEventListener("click",p,!0)},10)}};return r.addEventListener("pointerdown",o),()=>{s(),r.removeEventListener("pointerdown",o)}}class yt extends Nt{constructor(e,t,i=0){var n,s,o,a,u,c,l;super(),this.totalDuration=t,this.numberOfChannels=i,this.minLength=0,this.maxLength=1/0,this.id=e.id||`region-${Math.random().toString(32).slice(2)}`,this.start=this.clampPosition(e.start),this.end=this.clampPosition((n=e.end)!==null&&n!==void 0?n:e.start),this.drag=(s=e.drag)===null||s===void 0||s,this.resize=(o=e.resize)===null||o===void 0||o,this.color=(a=e.color)!==null&&a!==void 0?a:"rgba(0, 0, 0, 0.1)",this.minLength=(u=e.minLength)!==null&&u!==void 0?u:this.minLength,this.maxLength=(c=e.maxLength)!==null&&c!==void 0?c:this.maxLength,this.channelIdx=(l=e.channelIdx)!==null&&l!==void 0?l:-1,this.element=this.initElement(),this.setContent(e.content),this.setPart(),this.renderPosition(),this.initMouseEvents()}clampPosition(e){return Math.max(0,Math.min(this.totalDuration,e))}setPart(){const e=this.start===this.end;this.element.setAttribute("part",`${e?"marker":"region"} ${this.id}`)}addResizeHandles(e){const t=document.createElement("div");t.setAttribute("data-resize","left"),t.setAttribute("style",`
        position: absolute;
        z-index: 2;
        width: 6px;
        height: 100%;
        top: 0;
        left: 0;
        border-left: 2px solid rgba(0, 0, 0, 0.5);
        border-radius: 2px 0 0 2px;
        cursor: ew-resize;
        word-break: keep-all;
      `),t.setAttribute("part","region-handle region-handle-left");const i=t.cloneNode();i.setAttribute("data-resize","right"),i.style.left="",i.style.right="0",i.style.borderRight=i.style.borderLeft,i.style.borderLeft="",i.style.borderRadius="0 2px 2px 0",i.setAttribute("part","region-handle region-handle-right"),e.appendChild(t),e.appendChild(i),Ie(t,n=>this.onResize(n,"start"),()=>null,()=>this.onEndResizing(),1),Ie(i,n=>this.onResize(n,"end"),()=>null,()=>this.onEndResizing(),1)}removeResizeHandles(e){const t=e.querySelector('[data-resize="left"]'),i=e.querySelector('[data-resize="right"]');t&&e.removeChild(t),i&&e.removeChild(i)}initElement(){const e=document.createElement("div"),t=this.start===this.end;let i=0,n=100;return this.channelIdx>=0&&this.channelIdx<this.numberOfChannels&&(n=100/this.numberOfChannels,i=n*this.channelIdx),e.setAttribute("style",`
      position: absolute;
      top: ${i}%;
      height: ${n}%;
      background-color: ${t?"none":this.color};
      border-left: ${t?"2px solid "+this.color:"none"};
      border-radius: 2px;
      box-sizing: border-box;
      transition: background-color 0.2s ease;
      cursor: ${this.drag?"grab":"default"};
      pointer-events: all;
    `),!t&&this.resize&&this.addResizeHandles(e),e}renderPosition(){const e=this.start/this.totalDuration,t=(this.totalDuration-this.end)/this.totalDuration;this.element.style.left=100*e+"%",this.element.style.right=100*t+"%"}initMouseEvents(){const{element:e}=this;e&&(e.addEventListener("click",t=>this.emit("click",t)),e.addEventListener("mouseenter",t=>this.emit("over",t)),e.addEventListener("mouseleave",t=>this.emit("leave",t)),e.addEventListener("dblclick",t=>this.emit("dblclick",t)),Ie(e,t=>this.onMove(t),()=>this.onStartMoving(),()=>this.onEndMoving()))}onStartMoving(){this.drag&&(this.element.style.cursor="grabbing")}onEndMoving(){this.drag&&(this.element.style.cursor="grab",this.emit("update-end"))}_onUpdate(e,t){if(!this.element.parentElement)return;const i=e/this.element.parentElement.clientWidth*this.totalDuration,n=t&&t!=="start"?this.start:this.start+i,s=t&&t!=="end"?this.end:this.end+i,o=s-n;n>=0&&s<=this.totalDuration&&n<=s&&o>=this.minLength&&o<=this.maxLength&&(this.start=n,this.end=s,this.renderPosition(),this.emit("update"))}onMove(e){this.drag&&this._onUpdate(e)}onResize(e,t){this.resize&&this._onUpdate(e,t)}onEndResizing(){this.resize&&this.emit("update-end")}_setTotalDuration(e){this.totalDuration=e,this.renderPosition()}play(){this.emit("play")}setContent(e){var t;if((t=this.content)===null||t===void 0||t.remove(),e){if(typeof e=="string"){this.content=document.createElement("div");const i=this.start===this.end;this.content.style.padding=`0.2em ${i?.2:.4}em`,this.content.textContent=e}else this.content=e;this.content.setAttribute("part","region-content"),this.element.appendChild(this.content)}else this.content=void 0}setOptions(e){var t,i;if(e.color&&(this.color=e.color,this.element.style.backgroundColor=this.color),e.drag!==void 0&&(this.drag=e.drag,this.element.style.cursor=this.drag?"grab":"default"),e.start!==void 0||e.end!==void 0){const n=this.start===this.end;this.start=this.clampPosition((t=e.start)!==null&&t!==void 0?t:this.start),this.end=this.clampPosition((i=e.end)!==null&&i!==void 0?i:n?this.start:this.end),this.renderPosition(),this.setPart()}if(e.content&&this.setContent(e.content),e.id&&(this.id=e.id,this.setPart()),e.resize!==void 0&&e.resize!==this.resize){const n=this.start===this.end;this.resize=e.resize,this.resize&&!n?this.addResizeHandles(this.element):this.removeResizeHandles(this.element)}}remove(){this.emit("remove"),this.element.remove(),this.element=null}}class at extends Ji{constructor(e){super(e),this.regions=[],this.regionsContainer=this.initRegionsContainer()}static create(e){return new at(e)}onInit(){if(!this.wavesurfer)throw Error("WaveSurfer is not initialized");this.wavesurfer.getWrapper().appendChild(this.regionsContainer);let e=[];this.subscriptions.push(this.wavesurfer.on("timeupdate",t=>{const i=this.regions.filter(n=>n.start<=t&&n.end>=t);i.forEach(n=>{e.includes(n)||this.emit("region-in",n)}),e.forEach(n=>{i.includes(n)||this.emit("region-out",n)}),e=i}))}initRegionsContainer(){const e=document.createElement("div");return e.setAttribute("style",`
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 3;
      pointer-events: none;
    `),e}getRegions(){return this.regions}avoidOverlapping(e){if(!e.content)return;const t=e.content,i=t.getBoundingClientRect().left,n=e.element.scrollWidth,s=this.regions.filter(o=>{if(o===e||!o.content)return!1;const a=o.content.getBoundingClientRect().left,u=o.element.scrollWidth;return i<a+u&&a<i+n}).map(o=>{var a;return((a=o.content)===null||a===void 0?void 0:a.getBoundingClientRect().height)||0}).reduce((o,a)=>o+a,0);t.style.marginTop=`${s}px`}saveRegion(e){this.regionsContainer.appendChild(e.element),this.avoidOverlapping(e),this.regions.push(e);const t=[e.on("update-end",()=>{this.avoidOverlapping(e),this.emit("region-updated",e)}),e.on("play",()=>{var i,n;(i=this.wavesurfer)===null||i===void 0||i.play(),(n=this.wavesurfer)===null||n===void 0||n.setTime(e.start)}),e.on("click",i=>{this.emit("region-clicked",e,i)}),e.on("dblclick",i=>{this.emit("region-double-clicked",e,i)}),e.once("remove",()=>{t.forEach(i=>i()),this.regions=this.regions.filter(i=>i!==e)})];this.subscriptions.push(...t),this.emit("region-created",e)}addRegion(e){var t,i;if(!this.wavesurfer)throw Error("WaveSurfer is not initialized");const n=this.wavesurfer.getDuration(),s=(i=(t=this.wavesurfer)===null||t===void 0?void 0:t.getDecodedData())===null||i===void 0?void 0:i.numberOfChannels,o=new yt(e,n,s);return n?this.saveRegion(o):this.subscriptions.push(this.wavesurfer.once("ready",a=>{o._setTotalDuration(a),this.saveRegion(o)})),o}enableDragSelection(e){var t,i;const n=(i=(t=this.wavesurfer)===null||t===void 0?void 0:t.getWrapper())===null||i===void 0?void 0:i.querySelector("div");if(!n)return()=>{};let s=null,o=0;return Ie(n,(a,u,c)=>{s&&s._onUpdate(a,c>o?"end":"start")},a=>{var u,c;if(o=a,!this.wavesurfer)return;const l=this.wavesurfer.getDuration(),d=(c=(u=this.wavesurfer)===null||u===void 0?void 0:u.getDecodedData())===null||c===void 0?void 0:c.numberOfChannels,p=this.wavesurfer.getWrapper().clientWidth,h=a/p*l,f=(a+5)/p*l;s=new yt(Object.assign(Object.assign({},e),{start:h,end:f}),l,d),this.regionsContainer.appendChild(s.element)},()=>{s&&(this.saveRegion(s),s=null)})}clearRegions(){this.regions.forEach(e=>e.remove())}destroy(){this.clearRegions(),super.destroy()}}const{SvelteComponent:Qi,check_outros:en,create_component:ut,destroy_component:dt,detach:tn,empty:nn,flush:sn,group_outros:rn,init:on,insert:ln,mount_component:ct,safe_not_equal:an,transition_in:We,transition_out:Oe}=window.__gradio__svelte__internal;function un(r){let e,t;return e=new Di({}),{c(){ut(e.$$.fragment)},m(i,n){ct(e,i,n),t=!0},i(i){t||(We(e.$$.fragment,i),t=!0)},o(i){Oe(e.$$.fragment,i),t=!1},d(i){dt(e,i)}}}function dn(r){let e,t;return e=new ki({}),{c(){ut(e.$$.fragment)},m(i,n){ct(e,i,n),t=!0},i(i){t||(We(e.$$.fragment,i),t=!0)},o(i){Oe(e.$$.fragment,i),t=!1},d(i){dt(e,i)}}}function cn(r){let e,t;return e=new Vi({}),{c(){ut(e.$$.fragment)},m(i,n){ct(e,i,n),t=!0},i(i){t||(We(e.$$.fragment,i),t=!0)},o(i){Oe(e.$$.fragment,i),t=!1},d(i){dt(e,i)}}}function hn(r){let e,t,i,n;const s=[cn,dn,un],o=[];function a(u,c){return u[0]==0?0:u[0]<.5?1:u[0]>=.5?2:-1}return~(e=a(r))&&(t=o[e]=s[e](r)),{c(){t&&t.c(),i=nn()},m(u,c){~e&&o[e].m(u,c),ln(u,i,c),n=!0},p(u,[c]){let l=e;e=a(u),e!==l&&(t&&(rn(),Oe(o[l],1,1,()=>{o[l]=null}),en()),~e?(t=o[e],t||(t=o[e]=s[e](u),t.c()),We(t,1),t.m(i.parentNode,i)):t=null)},i(u){n||(We(t),n=!0)},o(u){Oe(t),n=!1},d(u){u&&tn(i),~e&&o[e].d(u)}}}function fn(r,e,t){let{currentVolume:i}=e;return r.$$set=n=>{"currentVolume"in n&&t(0,i=n.currentVolume)},[i]}class mn extends Qi{constructor(e){super(),on(this,e,fn,hn,an,{currentVolume:0})}get currentVolume(){return this.$$.ctx[0]}set currentVolume(e){this.$$set({currentVolume:e}),sn()}}const{SvelteComponent:_n,attr:ke,binding_callbacks:pn,detach:gn,element:vn,flush:et,init:bn,insert:wn,listen:kt,noop:Ct,run_all:yn,safe_not_equal:kn}=window.__gradio__svelte__internal,{onMount:Cn}=window.__gradio__svelte__internal;function En(r){let e,t,i;return{c(){e=vn("input"),ke(e,"id","volume"),ke(e,"class","volume-slider svelte-wuo8j5"),ke(e,"type","range"),ke(e,"min","0"),ke(e,"max","1"),ke(e,"step","0.01"),e.value=r[0]},m(n,s){wn(n,e,s),r[4](e),t||(i=[kt(e,"focusout",r[5]),kt(e,"input",r[6])],t=!0)},p(n,[s]){s&1&&(e.value=n[0])},i:Ct,o:Ct,d(n){n&&gn(e),r[4](null),t=!1,yn(i)}}}function Sn(r,e,t){let{currentVolume:i=1}=e,{show_volume_slider:n=!1}=e,{waveform:s}=e,o;Cn(()=>{a()});const a=()=>{let d=o;d&&(d.style.background=`linear-gradient(to right, var(--color-accent) ${i*100}%, var(--neutral-400) ${i*100}%)`)};function u(d){pn[d?"unshift":"push"](()=>{o=d,t(3,o)})}const c=()=>t(1,n=!1),l=d=>{d.target instanceof HTMLInputElement&&(t(0,i=parseFloat(d.target.value)),s?.setVolume(i))};return r.$$set=d=>{"currentVolume"in d&&t(0,i=d.currentVolume),"show_volume_slider"in d&&t(1,n=d.show_volume_slider),"waveform"in d&&t(2,s=d.waveform)},r.$$.update=()=>{r.$$.dirty&1&&a()},[i,n,s,o,u,c,l]}class Ln extends _n{constructor(e){super(),bn(this,e,Sn,En,kn,{currentVolume:0,show_volume_slider:1,waveform:2})}get currentVolume(){return this.$$.ctx[0]}set currentVolume(e){this.$$set({currentVolume:e}),et()}get show_volume_slider(){return this.$$.ctx[1]}set show_volume_slider(e){this.$$set({show_volume_slider:e}),et()}get waveform(){return this.$$.ctx[2]}set waveform(e){this.$$set({waveform:e}),et()}}const{SvelteComponent:Rn,add_flush_callback:Et,append:V,attr:$,bind:St,binding_callbacks:Lt,check_outros:$e,create_component:oe,destroy_component:le,detach:ae,element:F,empty:Mn,flush:q,group_outros:De,init:$n,insert:ue,listen:te,mount_component:de,noop:Pe,run_all:jt,safe_not_equal:Dn,set_data:Pn,set_style:Rt,space:re,text:Mt,toggle_class:$t,transition_in:T,transition_out:H}=window.__gradio__svelte__internal;function Dt(r){let e,t,i,n;function s(u){r[27](u)}function o(u){r[28](u)}let a={waveform:r[2]};return r[12]!==void 0&&(a.currentVolume=r[12]),r[1]!==void 0&&(a.show_volume_slider=r[1]),e=new Ln({props:a}),Lt.push(()=>St(e,"currentVolume",s)),Lt.push(()=>St(e,"show_volume_slider",o)),{c(){oe(e.$$.fragment)},m(u,c){de(e,u,c),n=!0},p(u,c){const l={};c[0]&4&&(l.waveform=u[2]),!t&&c[0]&4096&&(t=!0,l.currentVolume=u[12],Et(()=>t=!1)),!i&&c[0]&2&&(i=!0,l.show_volume_slider=u[1],Et(()=>i=!1)),e.$set(l)},i(u){n||(T(e.$$.fragment,u),n=!0)},o(u){H(e.$$.fragment,u),n=!1},d(u){le(e,u)}}}function Tn(r){let e,t;return e=new Yt({}),{c(){oe(e.$$.fragment)},m(i,n){de(e,i,n),t=!0},i(i){t||(T(e.$$.fragment,i),t=!0)},o(i){H(e.$$.fragment,i),t=!1},d(i){le(e,i)}}}function An(r){let e,t;return e=new Gt({}),{c(){oe(e.$$.fragment)},m(i,n){de(e,i,n),t=!0},i(i){t||(T(e.$$.fragment,i),t=!0)},o(i){H(e.$$.fragment,i),t=!1},d(i){le(e,i)}}}function Pt(r){let e,t,i,n,s,o=r[6]&&r[0]===""&&Tt(r);const a=[On,Wn],u=[];function c(l,d){return l[0]===""?0:1}return t=c(r),i=u[t]=a[t](r),{c(){o&&o.c(),e=re(),i.c(),n=Mn()},m(l,d){o&&o.m(l,d),ue(l,e,d),u[t].m(l,d),ue(l,n,d),s=!0},p(l,d){l[6]&&l[0]===""?o?(o.p(l,d),d[0]&65&&T(o,1)):(o=Tt(l),o.c(),T(o,1),o.m(e.parentNode,e)):o&&(De(),H(o,1,1,()=>{o=null}),$e());let p=t;t=c(l),t===p?u[t].p(l,d):(De(),H(u[p],1,1,()=>{u[p]=null}),$e(),i=u[t],i?i.p(l,d):(i=u[t]=a[t](l),i.c()),T(i,1),i.m(n.parentNode,n))},i(l){s||(T(o),T(i),s=!0)},o(l){H(o),H(i),s=!1},d(l){l&&(ae(e),ae(n)),o&&o.d(l),u[t].d(l)}}}function Tt(r){let e,t,i,n,s;return t=new Kt({}),{c(){e=F("button"),oe(t.$$.fragment),$(e,"class","action icon svelte-ije4bl"),$(e,"aria-label","Reset audio")},m(o,a){ue(o,e,a),de(t,e,null),i=!0,n||(s=te(e,"click",r[33]),n=!0)},p:Pe,i(o){i||(T(t.$$.fragment,o),i=!0)},o(o){H(t.$$.fragment,o),i=!1},d(o){o&&ae(e),le(t),n=!1,s()}}}function Wn(r){let e,t,i,n,s;return{c(){e=F("button"),e.textContent="Trim",t=re(),i=F("button"),i.textContent="Cancel",$(e,"class","text-button svelte-ije4bl"),$(i,"class","text-button svelte-ije4bl")},m(o,a){ue(o,e,a),ue(o,t,a),ue(o,i,a),n||(s=[te(e,"click",r[14]),te(i,"click",r[16])],n=!0)},p:Pe,i:Pe,o:Pe,d(o){o&&(ae(e),ae(t),ae(i)),n=!1,jt(s)}}}function On(r){let e,t,i,n,s;return t=new Zt({}),{c(){e=F("button"),oe(t.$$.fragment),$(e,"class","action icon svelte-ije4bl"),$(e,"aria-label","Trim audio to selection")},m(o,a){ue(o,e,a),de(t,e,null),i=!0,n||(s=te(e,"click",r[16]),n=!0)},p:Pe,i(o){i||(T(t.$$.fragment,o),i=!0)},o(o){H(t.$$.fragment,o),i=!1},d(o){o&&ae(e),le(t),n=!1,s()}}}function zn(r){let e,t,i,n,s,o,a,u,c,l,d,p,h,f,k,S,b,w,R,E,y,m,g,C,M,N,x,j,me,_e;n=new mn({props:{currentVolume:r[12]}});let D=r[1]&&Dt(r);k=new oi({});const ge=[An,Tn],K=[];function ve(L,A){return L[5]?0:1}R=ve(r),E=K[R]=ge[R](r),C=new mi({});let P=r[10]&&r[7]&&Pt(r);return{c(){e=F("div"),t=F("div"),i=F("button"),oe(n.$$.fragment),s=re(),D&&D.c(),o=re(),a=F("button"),u=F("span"),c=Mt(r[11]),l=Mt("x"),p=re(),h=F("div"),f=F("button"),oe(k.$$.fragment),b=re(),w=F("button"),E.c(),m=re(),g=F("button"),oe(C.$$.fragment),N=re(),x=F("div"),P&&P.c(),$(i,"class","action icon volume svelte-ije4bl"),$(i,"aria-label","Adjust volume"),Rt(i,"color",r[1]?"var(--color-accent)":"var(--neutral-400)"),$(a,"class","playback icon svelte-ije4bl"),$(a,"aria-label",d=`Adjust playback speed to ${r[13][(r[13].indexOf(r[11])+1)%r[13].length]}x`),$t(a,"hidden",r[1]),$(t,"class","control-wrapper svelte-ije4bl"),$(f,"class","rewind icon svelte-ije4bl"),$(f,"aria-label",S=`Skip backwards by ${Ee(r[3],r[9].skip_length)} seconds`),$(w,"class","play-pause-button icon svelte-ije4bl"),$(w,"aria-label",y=r[5]?r[4]("audio.pause"):r[4]("audio.play")),$(g,"class","skip icon svelte-ije4bl"),$(g,"aria-label",M="Skip forward by "+Ee(r[3],r[9].skip_length)+" seconds"),$(h,"class","play-pause-wrapper svelte-ije4bl"),$(x,"class","settings-wrapper svelte-ije4bl"),$(e,"class","controls svelte-ije4bl"),$(e,"data-testid","waveform-controls")},m(L,A){ue(L,e,A),V(e,t),V(t,i),de(n,i,null),V(t,s),D&&D.m(t,null),V(t,o),V(t,a),V(a,u),V(u,c),V(u,l),V(e,p),V(e,h),V(h,f),de(k,f,null),V(h,b),V(h,w),K[R].m(w,null),V(h,m),V(h,g),de(C,g,null),V(e,N),V(e,x),P&&P.m(x,null),j=!0,me||(_e=[te(i,"click",r[26]),te(a,"click",r[29]),te(f,"click",r[30]),te(w,"click",r[31]),te(g,"click",r[32])],me=!0)},p(L,A){const be={};A[0]&4096&&(be.currentVolume=L[12]),n.$set(be),A[0]&2&&Rt(i,"color",L[1]?"var(--color-accent)":"var(--neutral-400)"),L[1]?D?(D.p(L,A),A[0]&2&&T(D,1)):(D=Dt(L),D.c(),T(D,1),D.m(t,o)):D&&(De(),H(D,1,1,()=>{D=null}),$e()),(!j||A[0]&2048)&&Pn(c,L[11]),(!j||A[0]&2048&&d!==(d=`Adjust playback speed to ${L[13][(L[13].indexOf(L[11])+1)%L[13].length]}x`))&&$(a,"aria-label",d),(!j||A[0]&2)&&$t(a,"hidden",L[1]),(!j||A[0]&520&&S!==(S=`Skip backwards by ${Ee(L[3],L[9].skip_length)} seconds`))&&$(f,"aria-label",S);let v=R;R=ve(L),R!==v&&(De(),H(K[v],1,1,()=>{K[v]=null}),$e(),E=K[R],E||(E=K[R]=ge[R](L),E.c()),T(E,1),E.m(w,null)),(!j||A[0]&48&&y!==(y=L[5]?L[4]("audio.pause"):L[4]("audio.play")))&&$(w,"aria-label",y),(!j||A[0]&520&&M!==(M="Skip forward by "+Ee(L[3],L[9].skip_length)+" seconds"))&&$(g,"aria-label",M),L[10]&&L[7]?P?(P.p(L,A),A[0]&1152&&T(P,1)):(P=Pt(L),P.c(),T(P,1),P.m(x,null)):P&&(De(),H(P,1,1,()=>{P=null}),$e())},i(L){j||(T(n.$$.fragment,L),T(D),T(k.$$.fragment,L),T(E),T(C.$$.fragment,L),T(P),j=!0)},o(L){H(n.$$.fragment,L),H(D),H(k.$$.fragment,L),H(E),H(C.$$.fragment,L),H(P),j=!1},d(L){L&&ae(e),le(n),D&&D.d(),le(k),K[R].d(),le(C),P&&P.d(),me=!1,jt(_e)}}}function Hn(r,e,t){let{waveform:i}=e,{audio_duration:n}=e,{i18n:s}=e,{playing:o}=e,{show_redo:a=!1}=e,{interactive:u=!1}=e,{handle_trim_audio:c}=e,{mode:l=""}=e,{container:d}=e,{handle_reset_value:p}=e,{waveform_options:h={}}=e,{trim_region_settings:f={}}=e,{show_volume_slider:k=!1}=e,{editable:S=!0}=e,{trimDuration:b=0}=e,w=[.5,1,1.5,2],R=w[1],E=null,y=null,m,g,C="",M=1;const N=()=>{E&&(t(22,y=E?.addRegion({start:n/4,end:n/2,...f})),t(17,b=y.end-y.start))},x=()=>{if(i&&E&&y){const v=y.start,ie=y.end;c(v,ie),t(0,l=""),t(22,y=null)}},j=()=>{E?.getRegions().forEach(v=>{v.remove()}),E?.clearRegions()},me=()=>{j(),l==="edit"?t(0,l=""):(t(0,l="edit"),N())},_e=(v,ie)=>{let _,O;y&&(v==="left"?ie==="ArrowLeft"?(_=y.start-.05,O=y.end):(_=y.start+.05,O=y.end):ie==="ArrowLeft"?(_=y.start,O=y.end-.05):(_=y.start,O=y.end+.05),y.setOptions({start:_,end:O}),t(17,b=y.end-y.start))},D=()=>t(1,k=!k);function ge(v){M=v,t(12,M)}function K(v){k=v,t(1,k)}const ve=()=>{t(11,R=w[(w.indexOf(R)+1)%w.length]),i?.setPlaybackRate(R)},P=()=>i?.skip(Ee(n,h.skip_length)*-1),L=()=>i?.playPause(),A=()=>i?.skip(Ee(n,h.skip_length)),be=()=>{p(),j(),t(0,l="")};return r.$$set=v=>{"waveform"in v&&t(2,i=v.waveform),"audio_duration"in v&&t(3,n=v.audio_duration),"i18n"in v&&t(4,s=v.i18n),"playing"in v&&t(5,o=v.playing),"show_redo"in v&&t(6,a=v.show_redo),"interactive"in v&&t(7,u=v.interactive),"handle_trim_audio"in v&&t(18,c=v.handle_trim_audio),"mode"in v&&t(0,l=v.mode),"container"in v&&t(19,d=v.container),"handle_reset_value"in v&&t(8,p=v.handle_reset_value),"waveform_options"in v&&t(9,h=v.waveform_options),"trim_region_settings"in v&&t(20,f=v.trim_region_settings),"show_volume_slider"in v&&t(1,k=v.show_volume_slider),"editable"in v&&t(10,S=v.editable),"trimDuration"in v&&t(17,b=v.trimDuration)},r.$$.update=()=>{if(r.$$.dirty[0]&524292&&t(21,E=d&&i?i.registerPlugin(at.create()):null),r.$$.dirty[0]&2097152&&E?.on("region-out",v=>{v.play()}),r.$$.dirty[0]&2097152&&E?.on("region-updated",v=>{t(17,b=v.end-v.start)}),r.$$.dirty[0]&2097152&&E?.on("region-clicked",(v,ie)=>{ie.stopPropagation(),t(22,y=v),v.play()}),r.$$.dirty[0]&31981568&&y){const v=d.children[0].shadowRoot;t(24,g=v.querySelector('[data-resize="right"]')),t(23,m=v.querySelector('[data-resize="left"]')),m&&g&&(m.setAttribute("role","button"),g.setAttribute("role","button"),m?.setAttribute("aria-label","Drag to adjust start time"),g?.setAttribute("aria-label","Drag to adjust end time"),m?.setAttribute("tabindex","0"),g?.setAttribute("tabindex","0"),m.addEventListener("focus",()=>{E&&t(25,C="left")}),g.addEventListener("focus",()=>{E&&t(25,C="right")}))}r.$$.dirty[0]&35651584&&E&&window.addEventListener("keydown",v=>{v.key==="ArrowLeft"?_e(C,"ArrowLeft"):v.key==="ArrowRight"&&_e(C,"ArrowRight")})},[l,k,i,n,s,o,a,u,p,h,S,R,M,w,x,j,me,b,c,d,f,E,y,m,g,C,D,ge,K,ve,P,L,A,be]}class Vn extends Rn{constructor(e){super(),$n(this,e,Hn,zn,Dn,{waveform:2,audio_duration:3,i18n:4,playing:5,show_redo:6,interactive:7,handle_trim_audio:18,mode:0,container:19,handle_reset_value:8,waveform_options:9,trim_region_settings:20,show_volume_slider:1,editable:10,trimDuration:17},null,[-1,-1])}get waveform(){return this.$$.ctx[2]}set waveform(e){this.$$set({waveform:e}),q()}get audio_duration(){return this.$$.ctx[3]}set audio_duration(e){this.$$set({audio_duration:e}),q()}get i18n(){return this.$$.ctx[4]}set i18n(e){this.$$set({i18n:e}),q()}get playing(){return this.$$.ctx[5]}set playing(e){this.$$set({playing:e}),q()}get show_redo(){return this.$$.ctx[6]}set show_redo(e){this.$$set({show_redo:e}),q()}get interactive(){return this.$$.ctx[7]}set interactive(e){this.$$set({interactive:e}),q()}get handle_trim_audio(){return this.$$.ctx[18]}set handle_trim_audio(e){this.$$set({handle_trim_audio:e}),q()}get mode(){return this.$$.ctx[0]}set mode(e){this.$$set({mode:e}),q()}get container(){return this.$$.ctx[19]}set container(e){this.$$set({container:e}),q()}get handle_reset_value(){return this.$$.ctx[8]}set handle_reset_value(e){this.$$set({handle_reset_value:e}),q()}get waveform_options(){return this.$$.ctx[9]}set waveform_options(e){this.$$set({waveform_options:e}),q()}get trim_region_settings(){return this.$$.ctx[20]}set trim_region_settings(e){this.$$set({trim_region_settings:e}),q()}get show_volume_slider(){return this.$$.ctx[1]}set show_volume_slider(e){this.$$set({show_volume_slider:e}),q()}get editable(){return this.$$.ctx[10]}set editable(e){this.$$set({editable:e}),q()}get trimDuration(){return this.$$.ctx[17]}set trimDuration(e){this.$$set({trimDuration:e}),q()}}const{SvelteComponent:Nn,add_flush_callback:tt,append:Q,attr:U,bind:it,binding_callbacks:pe,bubble:jn,check_outros:Bn,create_component:ht,destroy_component:ft,detach:Te,element:ee,empty:qn,flush:Y,group_outros:In,init:Un,insert:Ae,listen:nt,mount_component:mt,run_all:Fn,safe_not_equal:Xn,set_data:xn,set_style:At,space:Me,text:Gn,toggle_class:Wt,transition_in:ze,transition_out:He}=window.__gradio__svelte__internal,{onMount:Zn}=window.__gradio__svelte__internal,{createEventDispatcher:Yn}=window.__gradio__svelte__internal;function Kn(r){let e,t,i,n,s,o,a,u,c,l,d,p,h,f,k,S,b,w=r[0]==="edit"&&r[16]>0&&Ot(r);function R(g){r[31](g)}function E(g){r[32](g)}function y(g){r[33](g)}let m={container:r[10],waveform:r[11],playing:r[14],audio_duration:r[15],i18n:r[3],interactive:r[4],handle_trim_audio:r[20],show_redo:r[4],handle_reset_value:r[9],waveform_options:r[8],trim_region_settings:r[6],editable:r[5]};return r[0]!==void 0&&(m.mode=r[0]),r[16]!==void 0&&(m.trimDuration=r[16]),r[17]!==void 0&&(m.show_volume_slider=r[17]),p=new Vn({props:m}),pe.push(()=>it(p,"mode",R)),pe.push(()=>it(p,"trimDuration",E)),pe.push(()=>it(p,"show_volume_slider",y)),{c(){e=ee("div"),t=ee("div"),i=ee("div"),n=Me(),s=ee("div"),o=ee("time"),o.textContent="0:00",a=Me(),u=ee("div"),w&&w.c(),c=Me(),l=ee("time"),l.textContent="0:00",d=Me(),ht(p.$$.fragment),U(i,"id","waveform"),U(i,"class","svelte-19usgod"),At(i,"height",r[10]?null:"58px"),U(t,"class","waveform-container svelte-19usgod"),U(o,"id","time"),U(o,"class","svelte-19usgod"),U(l,"id","duration"),U(l,"class","svelte-19usgod"),U(s,"class","timestamps svelte-19usgod"),U(e,"class","component-wrapper svelte-19usgod"),U(e,"data-testid",S=r[2]?"waveform-"+r[2]:"unlabelled-audio")},m(g,C){Ae(g,e,C),Q(e,t),Q(t,i),r[28](i),Q(e,n),Q(e,s),Q(s,o),r[29](o),Q(s,a),Q(s,u),w&&w.m(u,null),Q(u,c),Q(u,l),r[30](l),Q(e,d),mt(p,e,null),b=!0},p(g,C){C[0]&1024&&At(i,"height",g[10]?null:"58px"),g[0]==="edit"&&g[16]>0?w?w.p(g,C):(w=Ot(g),w.c(),w.m(u,c)):w&&(w.d(1),w=null);const M={};C[0]&1024&&(M.container=g[10]),C[0]&2048&&(M.waveform=g[11]),C[0]&16384&&(M.playing=g[14]),C[0]&32768&&(M.audio_duration=g[15]),C[0]&8&&(M.i18n=g[3]),C[0]&16&&(M.interactive=g[4]),C[0]&16&&(M.show_redo=g[4]),C[0]&512&&(M.handle_reset_value=g[9]),C[0]&256&&(M.waveform_options=g[8]),C[0]&64&&(M.trim_region_settings=g[6]),C[0]&32&&(M.editable=g[5]),!h&&C[0]&1&&(h=!0,M.mode=g[0],tt(()=>h=!1)),!f&&C[0]&65536&&(f=!0,M.trimDuration=g[16],tt(()=>f=!1)),!k&&C[0]&131072&&(k=!0,M.show_volume_slider=g[17],tt(()=>k=!1)),p.$set(M),(!b||C[0]&4&&S!==(S=g[2]?"waveform-"+g[2]:"unlabelled-audio"))&&U(e,"data-testid",S)},i(g){b||(ze(p.$$.fragment,g),b=!0)},o(g){He(p.$$.fragment,g),b=!1},d(g){g&&Te(e),r[28](null),r[29](null),w&&w.d(),r[30](null),ft(p)}}}function Jn(r){let e,t;return e=new Vt({props:{size:"small",$$slots:{default:[Qn]},$$scope:{ctx:r}}}),{c(){ht(e.$$.fragment)},m(i,n){mt(e,i,n),t=!0},p(i,n){const s={};n[1]&128&&(s.$$scope={dirty:n,ctx:i}),e.$set(s)},i(i){t||(ze(e.$$.fragment,i),t=!0)},o(i){He(e.$$.fragment,i),t=!1},d(i){ft(e,i)}}}function Ot(r){let e,t=Ue(r[16])+"",i;return{c(){e=ee("time"),i=Gn(t),U(e,"id","trim-duration"),U(e,"class","svelte-19usgod")},m(n,s){Ae(n,e,s),Q(e,i)},p(n,s){s[0]&65536&&t!==(t=Ue(n[16])+"")&&xn(i,t)},d(n){n&&Te(e)}}}function Qn(r){let e,t;return e=new ot({}),{c(){ht(e.$$.fragment)},m(i,n){mt(e,i,n),t=!0},i(i){t||(ze(e.$$.fragment,i),t=!0)},o(i){He(e.$$.fragment,i),t=!1},d(i){ft(e,i)}}}function es(r){let e,t,i,n,s,o,a,u,c;const l=[Jn,Kn],d=[];function p(h,f){return h[1]===null?0:h[1].is_stream?-1:1}return~(n=p(r))&&(s=d[n]=l[n](r)),{c(){e=ee("audio"),i=Me(),s&&s.c(),o=qn(),U(e,"class","standard-player svelte-19usgod"),e.controls=!0,e.autoplay=t=r[7].autoplay,Wt(e,"hidden",!(r[1]&&r[1].is_stream))},m(h,f){Ae(h,e,f),r[25](e),Ae(h,i,f),~n&&d[n].m(h,f),Ae(h,o,f),a=!0,u||(c=[nt(e,"load",r[24]),nt(e,"ended",r[26]),nt(e,"play",r[27])],u=!0)},p(h,f){(!a||f[0]&128&&t!==(t=h[7].autoplay))&&(e.autoplay=t),(!a||f[0]&2)&&Wt(e,"hidden",!(h[1]&&h[1].is_stream));let k=n;n=p(h),n===k?~n&&d[n].p(h,f):(s&&(In(),He(d[k],1,1,()=>{d[k]=null}),Bn()),~n?(s=d[n],s?s.p(h,f):(s=d[n]=l[n](h),s.c()),ze(s,1),s.m(o.parentNode,o)):s=null)},i(h){a||(ze(s),a=!0)},o(h){He(s),a=!1},d(h){h&&(Te(e),Te(i),Te(o)),r[25](null),~n&&d[n].d(h),u=!1,Fn(c)}}}function ts(r,e,t){let i,{value:n=null}=e,{label:s}=e,{i18n:o}=e,{dispatch_blob:a=()=>Promise.resolve()}=e,{interactive:u=!1}=e,{editable:c=!0}=e,{trim_region_settings:l={}}=e,{waveform_settings:d}=e,{waveform_options:p}=e,{mode:h=""}=e,{loop:f}=e,{handle_reset_value:k=()=>{}}=e,S,b,w=!1,R,E,y,m=0,g=!1,C,M=!1;const N=Yn(),x=()=>{t(11,b=lt.create({container:S,...d})),pt(n?.url).then(_=>{if(_&&b)return b.load(_)})},j=async(_,O)=>{t(0,h="");const je=b?.getDecodedData();je&&await Ki(je,_,O,d.sampleRate).then(async Se=>{await a([Se],"change"),b?.destroy(),t(10,S.innerHTML="",S)}),N("edit")};async function me(_){M=!1,await pt(_).then(O=>{if(!(!O||n?.is_stream))return b?.load(O)})}function _e(_){if(!(!_||!_.is_stream||!_.url)&&C)if(we.isSupported()&&!M){const O=new we({maxBufferLength:1,maxMaxBufferLength:1,lowLatencyMode:!0});O.loadSource(_.url),O.attachMedia(C),O.on(we.Events.MANIFEST_PARSED,function(){d.autoplay&&C.play()}),O.on(we.Events.ERROR,function(je,Se){if(console.error("HLS error:",je,Se),Se.fatal)switch(Se.type){case we.ErrorTypes.NETWORK_ERROR:console.error("Fatal network error encountered, trying to recover"),O.startLoad();break;case we.ErrorTypes.MEDIA_ERROR:console.error("Fatal media error encountered, trying to recover"),O.recoverMediaError();break;default:console.error("Fatal error, cannot recover"),O.destroy();break}}),M=!0}else M||(t(18,C.src=_.url,C),d.autoplay&&C.play(),M=!0)}Zn(()=>{window.addEventListener("keydown",_=>{!b||g||(_.key==="ArrowRight"&&h!=="edit"?wt(b,.1):_.key==="ArrowLeft"&&h!=="edit"&&wt(b,-.1))})});function D(_){jn.call(this,r,_)}function ge(_){pe[_?"unshift":"push"](()=>{C=_,t(18,C)})}const K=()=>N("stop"),ve=()=>N("play");function P(_){pe[_?"unshift":"push"](()=>{S=_,t(10,S),t(1,n),t(11,b)})}function L(_){pe[_?"unshift":"push"](()=>{R=_,t(12,R),t(11,b)})}function A(_){pe[_?"unshift":"push"](()=>{E=_,t(13,E),t(11,b)})}function be(_){h=_,t(0,h)}function v(_){m=_,t(16,m)}function ie(_){g=_,t(17,g)}return r.$$set=_=>{"value"in _&&t(1,n=_.value),"label"in _&&t(2,s=_.label),"i18n"in _&&t(3,o=_.i18n),"dispatch_blob"in _&&t(21,a=_.dispatch_blob),"interactive"in _&&t(4,u=_.interactive),"editable"in _&&t(5,c=_.editable),"trim_region_settings"in _&&t(6,l=_.trim_region_settings),"waveform_settings"in _&&t(7,d=_.waveform_settings),"waveform_options"in _&&t(8,p=_.waveform_options),"mode"in _&&t(0,h=_.mode),"loop"in _&&t(22,f=_.loop),"handle_reset_value"in _&&t(9,k=_.handle_reset_value)},r.$$.update=()=>{r.$$.dirty[0]&2&&t(23,i=n?.url),r.$$.dirty[0]&3074&&!n?.is_stream&&S!==void 0&&S!==null&&(b!==void 0&&b.destroy(),t(10,S.innerHTML="",S),x(),t(14,w=!1)),r.$$.dirty[0]&10240&&b?.on("decode",_=>{t(15,y=_),E&&t(13,E.textContent=Ue(_),E)}),r.$$.dirty[0]&6144&&b?.on("timeupdate",_=>R&&t(12,R.textContent=Ue(_),R)),r.$$.dirty[0]&2176&&b?.on("ready",()=>{d.autoplay?b?.play():b?.stop()}),r.$$.dirty[0]&4196352&&b?.on("finish",()=>{f?b?.play():(t(14,w=!1),N("stop"))}),r.$$.dirty[0]&2048&&b?.on("pause",()=>{t(14,w=!1),N("pause")}),r.$$.dirty[0]&2048&&b?.on("play",()=>{t(14,w=!0),N("play")}),r.$$.dirty[0]&2048&&b?.on("load",()=>{N("load")}),r.$$.dirty[0]&8388608&&i&&me(i),r.$$.dirty[0]&2&&_e(n)},[h,n,s,o,u,c,l,d,p,k,S,b,R,E,w,y,m,g,C,N,j,a,f,i,D,ge,K,ve,P,L,A,be,v,ie]}class is extends Nn{constructor(e){super(),Un(this,e,ts,es,Xn,{value:1,label:2,i18n:3,dispatch_blob:21,interactive:4,editable:5,trim_region_settings:6,waveform_settings:7,waveform_options:8,mode:0,loop:22,handle_reset_value:9},null,[-1,-1])}get value(){return this.$$.ctx[1]}set value(e){this.$$set({value:e}),Y()}get label(){return this.$$.ctx[2]}set label(e){this.$$set({label:e}),Y()}get i18n(){return this.$$.ctx[3]}set i18n(e){this.$$set({i18n:e}),Y()}get dispatch_blob(){return this.$$.ctx[21]}set dispatch_blob(e){this.$$set({dispatch_blob:e}),Y()}get interactive(){return this.$$.ctx[4]}set interactive(e){this.$$set({interactive:e}),Y()}get editable(){return this.$$.ctx[5]}set editable(e){this.$$set({editable:e}),Y()}get trim_region_settings(){return this.$$.ctx[6]}set trim_region_settings(e){this.$$set({trim_region_settings:e}),Y()}get waveform_settings(){return this.$$.ctx[7]}set waveform_settings(e){this.$$set({waveform_settings:e}),Y()}get waveform_options(){return this.$$.ctx[8]}set waveform_options(e){this.$$set({waveform_options:e}),Y()}get mode(){return this.$$.ctx[0]}set mode(e){this.$$set({mode:e}),Y()}get loop(){return this.$$.ctx[22]}set loop(e){this.$$set({loop:e}),Y()}get handle_reset_value(){return this.$$.ctx[9]}set handle_reset_value(e){this.$$set({handle_reset_value:e}),Y()}}const ns=is,{SvelteComponent:ss,bubble:Ce,check_outros:st,create_component:ce,destroy_component:he,detach:Ve,empty:Bt,flush:J,group_outros:rt,init:rs,insert:Ne,mount_component:fe,safe_not_equal:os,space:_t,transition_in:B,transition_out:X}=window.__gradio__svelte__internal,{createEventDispatcher:ls}=window.__gradio__svelte__internal;function as(r){let e,t;return e=new Vt({props:{size:"small",$$slots:{default:[ds]},$$scope:{ctx:r}}}),{c(){ce(e.$$.fragment)},m(i,n){fe(e,i,n),t=!0},p(i,n){const s={};n&524288&&(s.$$scope={dirty:n,ctx:i}),e.$set(s)},i(i){t||(B(e.$$.fragment,i),t=!0)},o(i){X(e.$$.fragment,i),t=!1},d(i){he(e,i)}}}function us(r){let e,t,i,n;return e=new xt({props:{display_top_corner:r[10],$$slots:{default:[hs]},$$scope:{ctx:r}}}),i=new ns({props:{value:r[0],label:r[1],i18n:r[5],waveform_settings:r[6],waveform_options:r[7],editable:r[8],loop:r[9]}}),i.$on("pause",r[14]),i.$on("play",r[15]),i.$on("stop",r[16]),i.$on("load",r[17]),{c(){ce(e.$$.fragment),t=_t(),ce(i.$$.fragment)},m(s,o){fe(e,s,o),Ne(s,t,o),fe(i,s,o),n=!0},p(s,o){const a={};o&1024&&(a.display_top_corner=s[10]),o&524345&&(a.$$scope={dirty:o,ctx:s}),e.$set(a);const u={};o&1&&(u.value=s[0]),o&2&&(u.label=s[1]),o&32&&(u.i18n=s[5]),o&64&&(u.waveform_settings=s[6]),o&128&&(u.waveform_options=s[7]),o&256&&(u.editable=s[8]),o&512&&(u.loop=s[9]),i.$set(u)},i(s){n||(B(e.$$.fragment,s),B(i.$$.fragment,s),n=!0)},o(s){X(e.$$.fragment,s),X(i.$$.fragment,s),n=!1},d(s){s&&Ve(t),he(e,s),he(i,s)}}}function ds(r){let e,t;return e=new ot({}),{c(){ce(e.$$.fragment)},m(i,n){fe(e,i,n),t=!0},i(i){t||(B(e.$$.fragment,i),t=!0)},o(i){X(e.$$.fragment,i),t=!1},d(i){he(e,i)}}}function zt(r){let e,t;return e=new Jt({props:{href:r[0].is_stream?r[0].url?.replace("playlist.m3u8","playlist-file"):r[0].url,download:r[0].orig_name||r[0].path,$$slots:{default:[cs]},$$scope:{ctx:r}}}),{c(){ce(e.$$.fragment)},m(i,n){fe(e,i,n),t=!0},p(i,n){const s={};n&1&&(s.href=i[0].is_stream?i[0].url?.replace("playlist.m3u8","playlist-file"):i[0].url),n&1&&(s.download=i[0].orig_name||i[0].path),n&524320&&(s.$$scope={dirty:n,ctx:i}),e.$set(s)},i(i){t||(B(e.$$.fragment,i),t=!0)},o(i){X(e.$$.fragment,i),t=!1},d(i){he(e,i)}}}function cs(r){let e,t;return e=new Ut({props:{Icon:Xt,label:r[5]("common.download")}}),{c(){ce(e.$$.fragment)},m(i,n){fe(e,i,n),t=!0},p(i,n){const s={};n&32&&(s.label=i[5]("common.download")),e.$set(s)},i(i){t||(B(e.$$.fragment,i),t=!0)},o(i){X(e.$$.fragment,i),t=!1},d(i){he(e,i)}}}function Ht(r){let e,t;return e=new Ft({props:{i18n:r[5],formatter:r[11],value:r[0]}}),e.$on("error",r[12]),e.$on("share",r[13]),{c(){ce(e.$$.fragment)},m(i,n){fe(e,i,n),t=!0},p(i,n){const s={};n&32&&(s.i18n=i[5]),n&1&&(s.value=i[0]),e.$set(s)},i(i){t||(B(e.$$.fragment,i),t=!0)},o(i){X(e.$$.fragment,i),t=!1},d(i){he(e,i)}}}function hs(r){let e,t,i,n=r[3]&&zt(r),s=r[4]&&Ht(r);return{c(){n&&n.c(),e=_t(),s&&s.c(),t=Bt()},m(o,a){n&&n.m(o,a),Ne(o,e,a),s&&s.m(o,a),Ne(o,t,a),i=!0},p(o,a){o[3]?n?(n.p(o,a),a&8&&B(n,1)):(n=zt(o),n.c(),B(n,1),n.m(e.parentNode,e)):n&&(rt(),X(n,1,1,()=>{n=null}),st()),o[4]?s?(s.p(o,a),a&16&&B(s,1)):(s=Ht(o),s.c(),B(s,1),s.m(t.parentNode,t)):s&&(rt(),X(s,1,1,()=>{s=null}),st())},i(o){i||(B(n),B(s),i=!0)},o(o){X(n),X(s),i=!1},d(o){o&&(Ve(e),Ve(t)),n&&n.d(o),s&&s.d(o)}}}function fs(r){let e,t,i,n,s,o;e=new It({props:{show_label:r[2],Icon:ot,float:!1,label:r[1]||r[5]("audio.audio")}});const a=[us,as],u=[];function c(l,d){return l[0]!==null?0:1}return i=c(r),n=u[i]=a[i](r),{c(){ce(e.$$.fragment),t=_t(),n.c(),s=Bt()},m(l,d){fe(e,l,d),Ne(l,t,d),u[i].m(l,d),Ne(l,s,d),o=!0},p(l,[d]){const p={};d&4&&(p.show_label=l[2]),d&34&&(p.label=l[1]||l[5]("audio.audio")),e.$set(p);let h=i;i=c(l),i===h?u[i].p(l,d):(rt(),X(u[h],1,1,()=>{u[h]=null}),st(),n=u[i],n?n.p(l,d):(n=u[i]=a[i](l),n.c()),B(n,1),n.m(s.parentNode,s))},i(l){o||(B(e.$$.fragment,l),B(n),o=!0)},o(l){X(e.$$.fragment,l),X(n),o=!1},d(l){l&&(Ve(t),Ve(s)),he(e,l),u[i].d(l)}}}function ms(r,e,t){let{value:i=null}=e,{label:n}=e,{show_label:s=!0}=e,{show_download_button:o=!0}=e,{show_share_button:a=!1}=e,{i18n:u}=e,{waveform_settings:c}=e,{waveform_options:l}=e,{editable:d=!0}=e,{loop:p}=e,{display_icon_button_wrapper_top_corner:h=!1}=e;const f=ls(),k=async m=>m?`<audio controls src="${await qt(m.url)}"></audio>`:"";function S(m){Ce.call(this,r,m)}function b(m){Ce.call(this,r,m)}function w(m){Ce.call(this,r,m)}function R(m){Ce.call(this,r,m)}function E(m){Ce.call(this,r,m)}function y(m){Ce.call(this,r,m)}return r.$$set=m=>{"value"in m&&t(0,i=m.value),"label"in m&&t(1,n=m.label),"show_label"in m&&t(2,s=m.show_label),"show_download_button"in m&&t(3,o=m.show_download_button),"show_share_button"in m&&t(4,a=m.show_share_button),"i18n"in m&&t(5,u=m.i18n),"waveform_settings"in m&&t(6,c=m.waveform_settings),"waveform_options"in m&&t(7,l=m.waveform_options),"editable"in m&&t(8,d=m.editable),"loop"in m&&t(9,p=m.loop),"display_icon_button_wrapper_top_corner"in m&&t(10,h=m.display_icon_button_wrapper_top_corner)},r.$$.update=()=>{r.$$.dirty&1&&i&&f("change",i)},[i,n,s,o,a,u,c,l,d,p,h,k,S,b,w,R,E,y]}class _s extends ss{constructor(e){super(),rs(this,e,ms,fs,os,{value:0,label:1,show_label:2,show_download_button:3,show_share_button:4,i18n:5,waveform_settings:6,waveform_options:7,editable:8,loop:9,display_icon_button_wrapper_top_corner:10})}get value(){return this.$$.ctx[0]}set value(e){this.$$set({value:e}),J()}get label(){return this.$$.ctx[1]}set label(e){this.$$set({label:e}),J()}get show_label(){return this.$$.ctx[2]}set show_label(e){this.$$set({show_label:e}),J()}get show_download_button(){return this.$$.ctx[3]}set show_download_button(e){this.$$set({show_download_button:e}),J()}get show_share_button(){return this.$$.ctx[4]}set show_share_button(e){this.$$set({show_share_button:e}),J()}get i18n(){return this.$$.ctx[5]}set i18n(e){this.$$set({i18n:e}),J()}get waveform_settings(){return this.$$.ctx[6]}set waveform_settings(e){this.$$set({waveform_settings:e}),J()}get waveform_options(){return this.$$.ctx[7]}set waveform_options(e){this.$$set({waveform_options:e}),J()}get editable(){return this.$$.ctx[8]}set editable(e){this.$$set({editable:e}),J()}get loop(){return this.$$.ctx[9]}set loop(e){this.$$set({loop:e}),J()}get display_icon_button_wrapper_top_corner(){return this.$$.ctx[10]}set display_icon_button_wrapper_top_corner(e){this.$$set({display_icon_button_wrapper_top_corner:e}),J()}}const As=Object.freeze(Object.defineProperty({__proto__:null,default:_s},Symbol.toStringTag,{value:"Module"}));export{ns as A,_s as S,Vn as W,lt as a,As as b,Ki as p,wt as s};
//# sourceMappingURL=StaticAudio-DJsYBhIx.js.map
