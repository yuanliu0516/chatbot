import{a as ce,i as fe,s as _e,Q as se,q as m,l as M,v as W,w as V,o as S,p as j,c as R,x as L,k as ie,$ as ae,m as T,F as te,t as b,b as k,d as U,A as We,f as y,r as Q,aq as ze,y as X,z as Y,a4 as Oe,I as $,E as me,J as Ge,K as Je,ax as Ke,N as Qe,P as Ve,aw as Xe,ap as Be,ar as Ye,M as ye,n as de,a6 as oe,a7 as ue,G as Ze,H as ge,W as $e,ay as xe,e as et,u as tt,h as it,j as lt}from"../lite.js";import{B as nt}from"./BlockLabel-B0HN-MOU.js";import{I as rt,F as st}from"./FullscreenButton-DBWlizLN.js";import{W as at,a as ot,S as ut}from"./SelectSource-CfNi7fcQ.js";import{I as ct}from"./IconButtonWrapper-jO_0NTSU.js";import{g as ft}from"./utils-Gtzs_Zla.js";import{D as Ce}from"./DropdownArrow-B85Vabzi.js";import{S as _t}from"./Square-7hK0fZD1.js";import{f as mt}from"./index-BW-aT-V7.js";import{S as dt}from"./StreamingBar-C8nPcBp-.js";import{U as gt}from"./Upload-BskNBEHw.js";import{I as ht}from"./Image-CU9FxpGN.js";function bt(n){let e,t,i;return{c(){e=se("svg"),t=se("path"),i=se("circle"),m(t,"d","M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"),m(i,"cx","12"),m(i,"cy","13"),m(i,"r","4"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"width","100%"),m(e,"height","100%"),m(e,"viewBox","0 0 24 24"),m(e,"fill","none"),m(e,"stroke","currentColor"),m(e,"stroke-width","1.5"),m(e,"stroke-linecap","round"),m(e,"stroke-linejoin","round"),m(e,"class","feather feather-camera")},m(l,s){M(l,e,s),W(e,t),W(e,i)},p:V,i:V,o:V,d(l){l&&S(e)}}}class wt extends ce{constructor(e){super(),fe(this,e,null,bt,_e,{})}}function pt(n){let e,t;return{c(){e=se("svg"),t=se("circle"),m(t,"cx","12"),m(t,"cy","12"),m(t,"r","10"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"width","100%"),m(e,"height","100%"),m(e,"viewBox","0 0 24 24"),m(e,"stroke-width","1.5"),m(e,"stroke-linecap","round"),m(e,"stroke-linejoin","round"),m(e,"class","feather feather-circle")},m(i,l){M(i,e,l),W(e,t)},p:V,i:V,o:V,d(i){i&&S(e)}}}class vt extends ce{constructor(e){super(),fe(this,e,null,pt,_e,{})}}function kt(n){let e,t,i,l,s,r="Click to Access Webcam",o,a,c,_;return l=new at({}),{c(){e=j("button"),t=j("div"),i=j("span"),R(l.$$.fragment),s=L(),o=ie(r),m(i,"class","icon-wrap svelte-qbrfs"),m(t,"class","wrap svelte-qbrfs"),m(e,"class","svelte-qbrfs"),ae(e,"height","100%")},m(f,I){M(f,e,I),W(e,t),W(t,i),T(l,i,null),W(t,s),W(t,o),a=!0,c||(_=te(e,"click",n[1]),c=!0)},p:V,i(f){a||(b(l.$$.fragment,f),a=!0)},o(f){k(l.$$.fragment,f),a=!1},d(f){f&&S(e),U(l),c=!1,_()}}}function It(n){const e=We();return[e,()=>e("click")]}class yt extends ce{constructor(e){super(),fe(this,e,It,kt,_e,{})}}function Wt(){return navigator.mediaDevices.enumerateDevices()}function Dt(n,e){e.srcObject=n,e.muted=!0,e.play()}async function Me(n,e,t,i){const l={video:i?{deviceId:{exact:i},...t?.video}:t?.video||{width:{ideal:1920},height:{ideal:1440}},audio:n&&(t?.audio??!0)};return navigator.mediaDevices.getUserMedia(l).then(s=>(Dt(s,e),s))}function zt(n){return n.filter(t=>t.kind==="videoinput")}function Se(n,e,t){const i=n.slice();return i[38]=e[t],i}function Bt(n){let e,t,i,l,s,r,o,a,c,_,f;const I=[jt,St],B=[];function C(p,z){return p[2]==="video"||p[1]?0:1}i=C(n),l=B[i]=I[i](n);let g=!n[11]&&je(n),w=n[13]&&n[8]&&qe(n);return{c(){e=j("div"),t=j("button"),l.c(),r=L(),g&&g.c(),o=L(),w&&w.c(),a=me(),m(t,"aria-label",s=n[2]==="image"?"capture photo":"start recording"),m(t,"class","svelte-s8feoe"),m(e,"class","button-wrap svelte-s8feoe")},m(p,z){M(p,e,z),W(e,t),B[i].m(t,null),W(e,r),g&&g.m(e,null),M(p,o,z),w&&w.m(p,z),M(p,a,z),c=!0,_||(f=te(t,"click",n[16]),_=!0)},p(p,z){let A=i;i=C(p),i===A?B[i].p(p,z):(X(),k(B[A],1,1,()=>{B[A]=null}),Y(),l=B[i],l?l.p(p,z):(l=B[i]=I[i](p),l.c()),b(l,1),l.m(t,null)),(!c||z[0]&4&&s!==(s=p[2]==="image"?"capture photo":"start recording"))&&m(t,"aria-label",s),p[11]?g&&(X(),k(g,1,1,()=>{g=null}),Y()):g?(g.p(p,z),z[0]&2048&&b(g,1)):(g=je(p),g.c(),b(g,1),g.m(e,null)),p[13]&&p[8]?w?(w.p(p,z),z[0]&8448&&b(w,1)):(w=qe(p),w.c(),b(w,1),w.m(a.parentNode,a)):w&&(X(),k(w,1,1,()=>{w=null}),Y())},i(p){c||(b(l),b(g),b(w),c=!0)},o(p){k(l),k(g),k(w),c=!1},d(p){p&&(S(e),S(o),S(a)),B[i].d(),g&&g.d(),w&&w.d(p),_=!1,f()}}}function Mt(n){let e,t,i,l;return t=new yt({}),t.$on("click",n[27]),{c(){e=j("div"),R(t.$$.fragment),m(e,"title","grant webcam access"),ae(e,"height","100%")},m(s,r){M(s,e,r),T(t,e,null),l=!0},p:V,i(s){l||(b(t.$$.fragment,s),s&&(i||Ge(()=>{i=Je(e,mt,{delay:100,duration:200}),i.start()})),l=!0)},o(s){k(t.$$.fragment,s),l=!1},d(s){s&&S(e),U(t)}}}function St(n){let e,t,i;return t=new wt({}),{c(){e=j("div"),R(t.$$.fragment),m(e,"class","icon svelte-s8feoe"),m(e,"title","capture photo")},m(l,s){M(l,e,s),T(t,e,null),i=!0},p:V,i(l){i||(b(t.$$.fragment,l),i=!0)},o(l){k(t.$$.fragment,l),i=!1},d(l){l&&S(e),U(t)}}}function jt(n){let e,t,i,l;const s=[Nt,Et,qt],r=[];function o(a,c){return a[1]&&a[10]==="waiting"?0:a[1]&&a[10]==="open"||!a[1]&&a[11]?1:2}return e=o(n),t=r[e]=s[e](n),{c(){t.c(),i=me()},m(a,c){r[e].m(a,c),M(a,i,c),l=!0},p(a,c){let _=e;e=o(a),e===_?r[e].p(a,c):(X(),k(r[_],1,1,()=>{r[_]=null}),Y(),t=r[e],t?t.p(a,c):(t=r[e]=s[e](a),t.c()),b(t,1),t.m(i.parentNode,i))},i(a){l||(b(t),l=!0)},o(a){k(t),l=!1},d(a){a&&S(i),r[e].d(a)}}}function qt(n){let e,t,i,l,s=n[4]("audio.record")+"",r,o;return i=new vt({}),{c(){e=j("div"),t=j("div"),R(i.$$.fragment),l=L(),r=ie(s),m(t,"class","icon color-primary svelte-s8feoe"),m(t,"title","start recording"),m(e,"class","icon-with-text svelte-s8feoe")},m(a,c){M(a,e,c),W(e,t),T(i,t,null),W(e,l),W(e,r),o=!0},p(a,c){(!o||c[0]&16)&&s!==(s=a[4]("audio.record")+"")&&de(r,s)},i(a){o||(b(i.$$.fragment,a),o=!0)},o(a){k(i.$$.fragment,a),o=!1},d(a){a&&S(e),U(i)}}}function Et(n){let e,t,i,l,s=n[4]("audio.stop")+"",r,o;return i=new _t({}),{c(){e=j("div"),t=j("div"),R(i.$$.fragment),l=L(),r=ie(s),m(t,"class","icon color-primary svelte-s8feoe"),m(t,"title","stop recording"),m(e,"class","icon-with-text svelte-s8feoe")},m(a,c){M(a,e,c),W(e,t),T(i,t,null),W(e,l),W(e,r),o=!0},p(a,c){(!o||c[0]&16)&&s!==(s=a[4]("audio.stop")+"")&&de(r,s)},i(a){o||(b(i.$$.fragment,a),o=!0)},o(a){k(i.$$.fragment,a),o=!1},d(a){a&&S(e),U(i)}}}function Nt(n){let e,t,i,l,s=n[4]("audio.waiting")+"",r,o;return i=new ot({}),{c(){e=j("div"),t=j("div"),R(i.$$.fragment),l=L(),r=ie(s),m(t,"class","icon color-primary svelte-s8feoe"),m(t,"title","spinner"),m(e,"class","icon-with-text svelte-s8feoe"),ae(e,"width","var(--size-24)")},m(a,c){M(a,e,c),W(e,t),T(i,t,null),W(e,l),W(e,r),o=!0},p(a,c){(!o||c[0]&16)&&s!==(s=a[4]("audio.waiting")+"")&&de(r,s)},i(a){o||(b(i.$$.fragment,a),o=!0)},o(a){k(i.$$.fragment,a),o=!1},d(a){a&&S(e),U(i)}}}function je(n){let e,t,i,l,s;return t=new Ce({}),{c(){e=j("button"),R(t.$$.fragment),m(e,"class","icon svelte-s8feoe"),m(e,"aria-label","select input source")},m(r,o){M(r,e,o),T(t,e,null),i=!0,l||(s=te(e,"click",n[28]),l=!0)},p:V,i(r){i||(b(t.$$.fragment,r),i=!0)},o(r){k(t.$$.fragment,r),i=!1},d(r){r&&S(e),U(t),l=!1,s()}}}function qe(n){let e,t,i,l,s,r,o;i=new Ce({});function a(f,I){return f[7].length===0?Tt:Rt}let c=a(n),_=c(n);return{c(){e=j("select"),t=j("button"),R(i.$$.fragment),l=L(),_.c(),m(t,"class","inset-icon svelte-s8feoe"),m(e,"class","select-wrap svelte-s8feoe"),m(e,"aria-label","select source")},m(f,I){M(f,e,I),W(e,t),T(i,t,null),W(t,l),_.m(e,null),s=!0,r||(o=[te(t,"click",Ke(n[29])),Qe(De.call(null,e,n[17])),te(e,"change",n[14])],r=!0)},p(f,I){c===(c=a(f))&&_?_.p(f,I):(_.d(1),_=c(f),_&&(_.c(),_.m(e,null)))},i(f){s||(b(i.$$.fragment,f),s=!0)},o(f){k(i.$$.fragment,f),s=!1},d(f){f&&S(e),U(i),_.d(),r=!1,Ve(o)}}}function Rt(n){let e,t=Be(n[7]),i=[];for(let l=0;l<t.length;l+=1)i[l]=Ee(Se(n,t,l));return{c(){for(let l=0;l<i.length;l+=1)i[l].c();e=me()},m(l,s){for(let r=0;r<i.length;r+=1)i[r]&&i[r].m(l,s);M(l,e,s)},p(l,s){if(s[0]&384){t=Be(l[7]);let r;for(r=0;r<t.length;r+=1){const o=Se(l,t,r);i[r]?i[r].p(o,s):(i[r]=Ee(o),i[r].c(),i[r].m(e.parentNode,e))}for(;r<i.length;r+=1)i[r].d(1);i.length=t.length}},d(l){l&&S(e),Ye(i,l)}}}function Tt(n){let e,t=n[4]("common.no_devices")+"",i;return{c(){e=j("option"),i=ie(t),e.__value="",ye(e,e.__value),m(e,"class","svelte-s8feoe")},m(l,s){M(l,e,s),W(e,i)},p(l,s){s[0]&16&&t!==(t=l[4]("common.no_devices")+"")&&de(i,t)},d(l){l&&S(e)}}}function Ee(n){let e,t=n[38].label+"",i,l,s,r;return{c(){e=j("option"),i=ie(t),l=L(),e.__value=s=n[38].deviceId,ye(e,e.__value),e.selected=r=n[8].deviceId===n[38].deviceId,m(e,"class","svelte-s8feoe")},m(o,a){M(o,e,a),W(e,i),W(e,l)},p(o,a){a[0]&128&&t!==(t=o[38].label+"")&&de(i,t),a[0]&128&&s!==(s=o[38].deviceId)&&(e.__value=s,ye(e,e.__value)),a[0]&384&&r!==(r=o[8].deviceId===o[38].deviceId)&&(e.selected=r)},d(o){o&&S(e)}}}function Ut(n){let e,t,i,l,s,r,o,a,c,_,f;t=new dt({props:{time_limit:n[9]}});const I=[Mt,Bt],B=[];function C(g,w){return g[12]?1:0}return c=C(n),_=B[c]=I[c](n),{c(){e=j("div"),R(t.$$.fragment),i=L(),l=j("video"),s=L(),r=j("img"),a=L(),_.c(),m(l,"class","svelte-s8feoe"),Q(l,"flip",n[3]),Q(l,"hide",!n[12]||n[12]&&!!n[0]),ze(r.src,o=n[0]?.url)||m(r,"src",o),m(r,"class","svelte-s8feoe"),Q(r,"hide",!n[12]||n[12]&&!n[0]),m(e,"class","wrap svelte-s8feoe")},m(g,w){M(g,e,w),T(t,e,null),W(e,i),W(e,l),n[26](l),W(e,s),W(e,r),W(e,a),B[c].m(e,null),f=!0},p(g,w){const p={};w[0]&512&&(p.time_limit=g[9]),t.$set(p),(!f||w[0]&8)&&Q(l,"flip",g[3]),(!f||w[0]&4097)&&Q(l,"hide",!g[12]||g[12]&&!!g[0]),(!f||w[0]&1&&!ze(r.src,o=g[0]?.url))&&m(r,"src",o),(!f||w[0]&4097)&&Q(r,"hide",!g[12]||g[12]&&!g[0]);let z=c;c=C(g),c===z?B[c].p(g,w):(X(),k(B[z],1,1,()=>{B[z]=null}),Y(),_=B[c],_?_.p(g,w):(_=B[c]=I[c](g),_.c()),b(_,1),_.m(e,null))},i(g){f||(b(t.$$.fragment,g),b(_),f=!0)},o(g){k(t.$$.fragment,g),k(_),f=!1},d(g){g&&S(e),U(t),n[26](null),B[c].d()}}}function De(n,e){const t=i=>{n&&!n.contains(i.target)&&!i.defaultPrevented&&e(i)};return document.addEventListener("click",t,!0),{destroy(){document.removeEventListener("click",t,!0)}}}function Ct(n,e,t){let i,l=[],s=null,r=null,o="closed";const a=h=>{h==="closed"?(t(9,r=null),t(10,o="closed"),t(0,O=null)):h==="waiting"?t(10,o="waiting"):t(10,o="open")},c=h=>{F&&t(9,r=h)};let _,{streaming:f=!1}=e,{pending:I=!1}=e,{root:B=""}=e,{stream_every:C=1}=e,{mode:g="image"}=e,{mirror_webcam:w}=e,{include_audio:p}=e,{webcam_constraints:z=null}=e,{i18n:A}=e,{upload:q}=e,{value:O=null}=e;const D=We();Oe(()=>{_=document.createElement("canvas"),f&&g==="image"&&window.setInterval(()=>{i&&!I&&H()},C*1e3)});const d=async h=>{const K=h.target.value;await Me(p,i,z,K).then(async ne=>{G=ne,t(8,s=l.find(re=>re.deviceId===K)||null),t(13,Z=!1)})};async function v(){try{Me(p,i,z).then(async h=>{t(12,le=!0),t(7,l=await Wt()),G=h}).then(()=>zt(l)).then(h=>{t(7,l=h);const N=G.getTracks().map(K=>K.getSettings()?.deviceId)[0];t(8,s=N&&h.find(K=>K.deviceId===N)||l[0])}),(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)&&D("error",A("image.no_webcam_support"))}catch(h){if(h instanceof DOMException&&h.name=="NotAllowedError")D("error",A("image.allow_webcam_access"));else throw h}}function H(){var h=_.getContext("2d");if((!f||f&&F)&&i.videoWidth&&i.videoHeight){if(_.width=i.videoWidth,_.height=i.videoHeight,h.drawImage(i,0,0,i.videoWidth,i.videoHeight),w&&(h.scale(-1,1),h.drawImage(i,-i.videoWidth,0)),f&&(!F||o==="waiting"))return;if(f){const N=_.toDataURL("image/jpeg");D("stream",N);return}_.toBlob(N=>{D(f?"stream":"capture",N)},`image/${f?"jpeg":"png"}`,.8)}}let F=!1,E=[],G,J,P;function x(){if(F){P.stop();let h=new Blob(E,{type:J}),N=new FileReader;N.onload=async function(K){if(K.target){let ne=new File([h],"sample."+J.substring(6));const re=await Xe([ne]);let Ie=(await q(re,B))?.filter(Boolean)[0];D("capture",Ie),D("stop_recording")}},N.readAsDataURL(h)}else{D("start_recording"),E=[];let h=["video/webm","video/mp4"];for(let N of h)if(MediaRecorder.isTypeSupported(N)){J=N;break}if(J===null){console.error("No supported MediaRecorder mimeType");return}P=new MediaRecorder(G,{mimeType:J}),P.addEventListener("dataavailable",function(N){E.push(N.data)}),P.start(200)}t(11,F=!F)}let le=!1;function he(){g==="image"&&f&&t(11,F=!F),g==="image"?H():x(),!F&&G&&(D("close_stream"),G.getTracks().forEach(h=>h.stop()),t(6,i.srcObject=null,i),t(12,le=!1),window.setTimeout(()=>{t(0,O=null)},500),t(0,O=null))}let Z=!1;function be(h){h.preventDefault(),h.stopPropagation(),t(13,Z=!1)}function we(h){$[h?"unshift":"push"](()=>{i=h,t(6,i)})}const pe=async()=>v(),ve=()=>t(13,Z=!0),ke=()=>t(13,Z=!1);return n.$$set=h=>{"streaming"in h&&t(1,f=h.streaming),"pending"in h&&t(20,I=h.pending),"root"in h&&t(21,B=h.root),"stream_every"in h&&t(22,C=h.stream_every),"mode"in h&&t(2,g=h.mode),"mirror_webcam"in h&&t(3,w=h.mirror_webcam),"include_audio"in h&&t(23,p=h.include_audio),"webcam_constraints"in h&&t(24,z=h.webcam_constraints),"i18n"in h&&t(4,A=h.i18n),"upload"in h&&t(25,q=h.upload),"value"in h&&t(0,O=h.value)},[O,f,g,w,A,De,i,l,s,r,o,F,le,Z,d,v,he,be,a,c,I,B,C,p,z,q,we,pe,ve,ke]}class Ft extends ce{constructor(e){super(),fe(this,e,Ct,Ut,_e,{modify_stream:18,set_time_limit:19,streaming:1,pending:20,root:21,stream_every:22,mode:2,mirror_webcam:3,include_audio:23,webcam_constraints:24,i18n:4,upload:25,value:0,click_outside:5},null,[-1,-1])}get modify_stream(){return this.$$.ctx[18]}get set_time_limit(){return this.$$.ctx[19]}get streaming(){return this.$$.ctx[1]}set streaming(e){this.$$set({streaming:e}),y()}get pending(){return this.$$.ctx[20]}set pending(e){this.$$set({pending:e}),y()}get root(){return this.$$.ctx[21]}set root(e){this.$$set({root:e}),y()}get stream_every(){return this.$$.ctx[22]}set stream_every(e){this.$$set({stream_every:e}),y()}get mode(){return this.$$.ctx[2]}set mode(e){this.$$set({mode:e}),y()}get mirror_webcam(){return this.$$.ctx[3]}set mirror_webcam(e){this.$$set({mirror_webcam:e}),y()}get include_audio(){return this.$$.ctx[23]}set include_audio(e){this.$$set({include_audio:e}),y()}get webcam_constraints(){return this.$$.ctx[24]}set webcam_constraints(e){this.$$set({webcam_constraints:e}),y()}get i18n(){return this.$$.ctx[4]}set i18n(e){this.$$set({i18n:e}),y()}get upload(){return this.$$.ctx[25]}set upload(e){this.$$set({upload:e}),y()}get value(){return this.$$.ctx[0]}set value(e){this.$$set({value:e}),y()}get click_outside(){return De}}const Lt=Ft;function Ne(n){let e,t,i,l=n[18]&&Re(n);return t=new $e({props:{Icon:xe,label:"Remove Image"}}),t.$on("click",n[31]),{c(){l&&l.c(),e=L(),R(t.$$.fragment)},m(s,r){l&&l.m(s,r),M(s,e,r),T(t,s,r),i=!0},p(s,r){s[18]?l?(l.p(s,r),r[0]&262144&&b(l,1)):(l=Re(s),l.c(),b(l,1),l.m(e.parentNode,e)):l&&(X(),k(l,1,1,()=>{l=null}),Y())},i(s){i||(b(l),b(t.$$.fragment,s),i=!0)},o(s){k(l),k(t.$$.fragment,s),i=!1},d(s){s&&S(e),l&&l.d(s),U(t,s)}}}function Re(n){let e,t;return e=new st({props:{container:n[22]}}),{c(){R(e.$$.fragment)},m(i,l){T(e,i,l),t=!0},p(i,l){const s={};l[0]&4194304&&(s.container=i[22]),e.$set(s)},i(i){t||(b(e.$$.fragment,i),t=!0)},o(i){k(e.$$.fragment,i),t=!1},d(i){U(e,i)}}}function At(n){let e,t,i=n[3]?.url&&!n[20]&&Ne(n);return{c(){i&&i.c(),e=me()},m(l,s){i&&i.m(l,s),M(l,e,s),t=!0},p(l,s){l[3]?.url&&!l[20]?i?(i.p(l,s),s[0]&1048584&&b(i,1)):(i=Ne(l),i.c(),b(i,1),i.m(e.parentNode,e)):i&&(X(),k(i,1,1,()=>{i=null}),Y())},i(l){t||(b(i),t=!0)},o(l){k(i),t=!1},d(l){l&&S(e),i&&i.d(l)}}}function Te(n){let e;const t=n[30].default,i=et(t,n,n[46],null);return{c(){i&&i.c()},m(l,s){i&&i.m(l,s),e=!0},p(l,s){i&&i.p&&(!e||s[1]&32768)&&tt(i,t,l,l[46],e?lt(t,l[46],s,null):it(l[46]),null)},i(l){e||(b(i,l),e=!0)},o(l){k(i,l),e=!1},d(l){i&&i.d(l)}}}function Ht(n){let e,t,i=n[3]===null&&Te(n);return{c(){i&&i.c(),e=me()},m(l,s){i&&i.m(l,s),M(l,e,s),t=!0},p(l,s){l[3]===null?i?(i.p(l,s),s[0]&8&&b(i,1)):(i=Te(l),i.c(),b(i,1),i.m(e.parentNode,e)):i&&(X(),k(i,1,1,()=>{i=null}),Y())},i(l){t||(b(i),t=!0)},o(l){k(i),t=!1},d(l){l&&S(e),i&&i.d(l)}}}function Pt(n){let e,t,i,l,s;return t=new ht({props:{src:n[3].url,alt:n[3].alt_text}}),{c(){e=j("div"),R(t.$$.fragment),m(e,"class","image-frame svelte-1ti4ehe"),Q(e,"selectable",n[11])},m(r,o){M(r,e,o),T(t,e,null),i=!0,l||(s=te(e,"click",n[27]),l=!0)},p(r,o){const a={};o[0]&8&&(a.src=r[3].url),o[0]&8&&(a.alt=r[3].alt_text),t.$set(a),(!i||o[0]&2048)&&Q(e,"selectable",r[11])},i(r){i||(b(t.$$.fragment,r),i=!0)},o(r){k(t.$$.fragment,r),i=!1},d(r){r&&S(e),U(t),l=!1,s()}}}function Ot(n){let e,t,i,l;function s(a){n[36](a)}function r(a){n[37](a)}let o={root:n[12],value:n[3],mirror_webcam:n[10],stream_every:n[17],streaming:n[9],mode:"image",include_audio:!1,i18n:n[13],upload:n[15],webcam_constraints:n[19]};return n[4]!==void 0&&(o.modify_stream=n[4]),n[5]!==void 0&&(o.set_time_limit=n[5]),e=new Lt({props:o}),$.push(()=>oe(e,"modify_stream",s)),$.push(()=>oe(e,"set_time_limit",r)),e.$on("capture",n[38]),e.$on("stream",n[39]),e.$on("error",n[40]),e.$on("drag",n[41]),e.$on("upload",n[42]),e.$on("close_stream",n[43]),{c(){R(e.$$.fragment)},m(a,c){T(e,a,c),l=!0},p(a,c){const _={};c[0]&4096&&(_.root=a[12]),c[0]&8&&(_.value=a[3]),c[0]&1024&&(_.mirror_webcam=a[10]),c[0]&131072&&(_.stream_every=a[17]),c[0]&512&&(_.streaming=a[9]),c[0]&8192&&(_.i18n=a[13]),c[0]&32768&&(_.upload=a[15]),c[0]&524288&&(_.webcam_constraints=a[19]),!t&&c[0]&16&&(t=!0,_.modify_stream=a[4],ue(()=>t=!1)),!i&&c[0]&32&&(i=!0,_.set_time_limit=a[5],ue(()=>i=!1)),e.$set(_)},i(a){l||(b(e.$$.fragment,a),l=!0)},o(a){k(e.$$.fragment,a),l=!1},d(a){U(e,a)}}}function Ue(n){let e,t,i;function l(r){n[44](r)}let s={sources:n[8],handle_clear:n[24],handle_select:n[28]};return n[1]!==void 0&&(s.active_source=n[1]),e=new ut({props:s}),$.push(()=>oe(e,"active_source",l)),{c(){R(e.$$.fragment)},m(r,o){T(e,r,o),i=!0},p(r,o){const a={};o[0]&256&&(a.sources=r[8]),!t&&o[0]&2&&(t=!0,a.active_source=r[1],ue(()=>t=!1)),e.$set(a)},i(r){i||(b(e.$$.fragment,r),i=!0)},o(r){k(e.$$.fragment,r),i=!1},d(r){U(e,r)}}}function Gt(n){let e,t,i,l,s,r,o,a,c,_,f,I,B,C=n[8].length>1||n[8].includes("clipboard"),g;e=new nt({props:{show_label:n[7],Icon:rt,label:n[6]||"Image"}}),l=new ct({props:{$$slots:{default:[At]},$$scope:{ctx:n}}});function w(d){n[33](d)}function p(d){n[34](d)}let z={hidden:n[3]!==null||n[1]==="webcam",filetype:n[1]==="clipboard"?"clipboard":"image/*",root:n[12],max_file_size:n[14],disable_click:!n[8].includes("upload")||n[3]!==null,upload:n[15],stream_handler:n[16],$$slots:{default:[Ht]},$$scope:{ctx:n}};n[0]!==void 0&&(z.uploading=n[0]),n[2]!==void 0&&(z.dragging=n[2]),o=new gt({props:z}),n[32](o),$.push(()=>oe(o,"uploading",w)),$.push(()=>oe(o,"dragging",p)),o.$on("load",n[23]),o.$on("error",n[35]);const A=[Ot,Pt],q=[];function O(d,v){return d[1]==="webcam"&&(d[9]||!d[9]&&!d[3])?0:d[3]!==null&&!d[9]?1:-1}~(f=O(n))&&(I=q[f]=A[f](n));let D=C&&Ue(n);return{c(){R(e.$$.fragment),t=L(),i=j("div"),R(l.$$.fragment),s=L(),r=j("div"),R(o.$$.fragment),_=L(),I&&I.c(),B=L(),D&&D.c(),m(r,"class","upload-container svelte-1ti4ehe"),Q(r,"reduced-height",n[8].length>1),ae(r,"width",n[3]?"auto":"100%"),m(i,"data-testid","image"),m(i,"class","image-container svelte-1ti4ehe")},m(d,v){T(e,d,v),M(d,t,v),M(d,i,v),T(l,i,null),W(i,s),W(i,r),T(o,r,null),W(r,_),~f&&q[f].m(r,null),W(i,B),D&&D.m(i,null),n[45](i),g=!0},p(d,v){const H={};v[0]&128&&(H.show_label=d[7]),v[0]&64&&(H.label=d[6]||"Image"),e.$set(H);const F={};v[0]&5505032|v[1]&32768&&(F.$$scope={dirty:v,ctx:d}),l.$set(F);const E={};v[0]&10&&(E.hidden=d[3]!==null||d[1]==="webcam"),v[0]&2&&(E.filetype=d[1]==="clipboard"?"clipboard":"image/*"),v[0]&4096&&(E.root=d[12]),v[0]&16384&&(E.max_file_size=d[14]),v[0]&264&&(E.disable_click=!d[8].includes("upload")||d[3]!==null),v[0]&32768&&(E.upload=d[15]),v[0]&65536&&(E.stream_handler=d[16]),v[0]&8|v[1]&32768&&(E.$$scope={dirty:v,ctx:d}),!a&&v[0]&1&&(a=!0,E.uploading=d[0],ue(()=>a=!1)),!c&&v[0]&4&&(c=!0,E.dragging=d[2],ue(()=>c=!1)),o.$set(E);let G=f;f=O(d),f===G?~f&&q[f].p(d,v):(I&&(X(),k(q[G],1,1,()=>{q[G]=null}),Y()),~f?(I=q[f],I?I.p(d,v):(I=q[f]=A[f](d),I.c()),b(I,1),I.m(r,null)):I=null),(!g||v[0]&256)&&Q(r,"reduced-height",d[8].length>1),v[0]&8&&ae(r,"width",d[3]?"auto":"100%"),v[0]&256&&(C=d[8].length>1||d[8].includes("clipboard")),C?D?(D.p(d,v),v[0]&256&&b(D,1)):(D=Ue(d),D.c(),b(D,1),D.m(i,null)):D&&(X(),k(D,1,1,()=>{D=null}),Y())},i(d){g||(b(e.$$.fragment,d),b(l.$$.fragment,d),b(o.$$.fragment,d),b(I),b(D),g=!0)},o(d){k(e.$$.fragment,d),k(l.$$.fragment,d),k(o.$$.fragment,d),k(I),k(D),g=!1},d(d){d&&(S(t),S(i)),U(e,d),U(l),n[32](null),U(o),~f&&q[f].d(),D&&D.d(),n[45](null)}}}function Jt(n,e,t){let i,{$$slots:l={},$$scope:s}=e,{value:r=null}=e,{label:o=void 0}=e,{show_label:a}=e,{sources:c=["upload","clipboard","webcam"]}=e,{streaming:_=!1}=e,{pending:f=!1}=e,{mirror_webcam:I}=e,{selectable:B=!1}=e,{root:C}=e,{i18n:g}=e,{max_file_size:w=null}=e,{upload:p}=e,{stream_handler:z}=e,{stream_every:A}=e,{modify_stream:q}=e,{set_time_limit:O}=e,{show_fullscreen_button:D=!0}=e,d,{uploading:v=!1}=e,{active_source:H=null}=e,{webcam_constraints:F=void 0}=e;function E({detail:u}){_||(t(3,r=u),P("upload"))}function G(){t(3,r=null),P("clear"),P("change",null)}async function J(u,ee){if(ee==="stream"){P("stream",{value:{url:u},is_value_data:!0});return}t(29,f=!0);const Pe=await d.load_files([new File([u],`image/${_?"jpeg":"png"}`)]);(ee==="change"||ee==="upload")&&(t(3,r=Pe?.[0]||null),await Ze(),P("change")),t(29,f=!1)}const P=We();let{dragging:x=!1}=e;function le(u){let ee=ft(u);ee&&P("select",{index:ee,value:null})}async function he(u){switch(u){case"clipboard":d.paste_clipboard();break}}let Z;const be=u=>{t(3,r=null),P("clear"),u.stopPropagation()};function we(u){$[u?"unshift":"push"](()=>{d=u,t(21,d)})}function pe(u){v=u,t(0,v)}function ve(u){x=u,t(2,x)}function ke(u){ge.call(this,n,u)}function h(u){q=u,t(4,q)}function N(u){O=u,t(5,O)}const K=u=>J(u.detail,"change"),ne=u=>J(u.detail,"stream");function re(u){ge.call(this,n,u)}function Ie(u){ge.call(this,n,u)}const Fe=u=>J(u.detail,"upload");function Le(u){ge.call(this,n,u)}function Ae(u){H=u,t(1,H),t(8,c)}function He(u){$[u?"unshift":"push"](()=>{Z=u,t(22,Z)})}return n.$$set=u=>{"value"in u&&t(3,r=u.value),"label"in u&&t(6,o=u.label),"show_label"in u&&t(7,a=u.show_label),"sources"in u&&t(8,c=u.sources),"streaming"in u&&t(9,_=u.streaming),"pending"in u&&t(29,f=u.pending),"mirror_webcam"in u&&t(10,I=u.mirror_webcam),"selectable"in u&&t(11,B=u.selectable),"root"in u&&t(12,C=u.root),"i18n"in u&&t(13,g=u.i18n),"max_file_size"in u&&t(14,w=u.max_file_size),"upload"in u&&t(15,p=u.upload),"stream_handler"in u&&t(16,z=u.stream_handler),"stream_every"in u&&t(17,A=u.stream_every),"modify_stream"in u&&t(4,q=u.modify_stream),"set_time_limit"in u&&t(5,O=u.set_time_limit),"show_fullscreen_button"in u&&t(18,D=u.show_fullscreen_button),"uploading"in u&&t(0,v=u.uploading),"active_source"in u&&t(1,H=u.active_source),"webcam_constraints"in u&&t(19,F=u.webcam_constraints),"dragging"in u&&t(2,x=u.dragging),"$$scope"in u&&t(46,s=u.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&258&&!H&&c&&t(1,H=c[0]),n.$$.dirty[0]&514&&t(20,i=_&&H==="webcam"),n.$$.dirty[0]&1048577&&v&&!i&&t(3,r=null),n.$$.dirty[0]&4&&P("drag",x)},[v,H,x,r,q,O,o,a,c,_,I,B,C,g,w,p,z,A,D,F,i,d,Z,E,G,J,P,le,he,f,l,be,we,pe,ve,ke,h,N,K,ne,re,Ie,Fe,Le,Ae,He,s]}class Kt extends ce{constructor(e){super(),fe(this,e,Jt,Gt,_e,{value:3,label:6,show_label:7,sources:8,streaming:9,pending:29,mirror_webcam:10,selectable:11,root:12,i18n:13,max_file_size:14,upload:15,stream_handler:16,stream_every:17,modify_stream:4,set_time_limit:5,show_fullscreen_button:18,uploading:0,active_source:1,webcam_constraints:19,dragging:2},null,[-1,-1])}get value(){return this.$$.ctx[3]}set value(e){this.$$set({value:e}),y()}get label(){return this.$$.ctx[6]}set label(e){this.$$set({label:e}),y()}get show_label(){return this.$$.ctx[7]}set show_label(e){this.$$set({show_label:e}),y()}get sources(){return this.$$.ctx[8]}set sources(e){this.$$set({sources:e}),y()}get streaming(){return this.$$.ctx[9]}set streaming(e){this.$$set({streaming:e}),y()}get pending(){return this.$$.ctx[29]}set pending(e){this.$$set({pending:e}),y()}get mirror_webcam(){return this.$$.ctx[10]}set mirror_webcam(e){this.$$set({mirror_webcam:e}),y()}get selectable(){return this.$$.ctx[11]}set selectable(e){this.$$set({selectable:e}),y()}get root(){return this.$$.ctx[12]}set root(e){this.$$set({root:e}),y()}get i18n(){return this.$$.ctx[13]}set i18n(e){this.$$set({i18n:e}),y()}get max_file_size(){return this.$$.ctx[14]}set max_file_size(e){this.$$set({max_file_size:e}),y()}get upload(){return this.$$.ctx[15]}set upload(e){this.$$set({upload:e}),y()}get stream_handler(){return this.$$.ctx[16]}set stream_handler(e){this.$$set({stream_handler:e}),y()}get stream_every(){return this.$$.ctx[17]}set stream_every(e){this.$$set({stream_every:e}),y()}get modify_stream(){return this.$$.ctx[4]}set modify_stream(e){this.$$set({modify_stream:e}),y()}get set_time_limit(){return this.$$.ctx[5]}set set_time_limit(e){this.$$set({set_time_limit:e}),y()}get show_fullscreen_button(){return this.$$.ctx[18]}set show_fullscreen_button(e){this.$$set({show_fullscreen_button:e}),y()}get uploading(){return this.$$.ctx[0]}set uploading(e){this.$$set({uploading:e}),y()}get active_source(){return this.$$.ctx[1]}set active_source(e){this.$$set({active_source:e}),y()}get webcam_constraints(){return this.$$.ctx[19]}set webcam_constraints(e){this.$$set({webcam_constraints:e}),y()}get dragging(){return this.$$.ctx[2]}set dragging(e){this.$$set({dragging:e}),y()}}const ri=Kt;export{ri as I,Lt as W};
//# sourceMappingURL=ImageUploader-CGwCduvY.js.map
